/*! For license information please see 367.85ce3606.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[367],{1006:function(t,e,a){"use strict";var n=a(348),r=a(347),o=a(351),i=a.n(o),s=a(0),l=a.n(s),c=a(363),d=l.a.forwardRef((function(t,e){var a=t.bsPrefix,o=t.className,s=Object(r.a)(t,["bsPrefix","className"]),d=Object(c.a)(a,"btn-toolbar");return l.a.createElement("div",Object(n.a)({},s,{ref:e,className:i()(o,d)}))}));d.displayName="ButtonToolbar",d.defaultProps={role:"toolbar"},e.a=d},1722:function(t,e,a){"use strict";var n=a(373),r=a(641),o=a(692),i=a(428),s=a(454),l=a(387),c=a(396),d=a(625),u=a(838).factory,p=a(350),v=a(693),h=a(2511),f=a(2512);t.exports=function(){var t,e,a,g,m,b;if(0===arguments.length)e=u();else if(1===arguments.length){if(!i(t=arguments[0]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+t+"`.");if(l(t,"prng")){if(!s(t.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+t.prng+"`.");e=t.prng}else e=u(t)}else{if(g=h(m=arguments[0],b=arguments[1]))throw g;if(arguments.length>2){if(!i(t=arguments[2]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+t+"`.");if(l(t,"prng")){if(!s(t.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+t.prng+"`.");e=t.prng}else e=u(t)}else e=u()}return n(a=void 0===m?S:F,"NAME","uniform"),t&&t.prng?(n(a,"seed",null),n(a,"seedLength",null),o(a,"state",c(null),d),n(a,"stateLength",null),n(a,"byteLength",null),n(a,"toJSON",c(null)),n(a,"PRNG",e)):(r(a,"seed",y),r(a,"seedLength",N),o(a,"state",x,k),r(a,"stateLength",C),r(a,"byteLength",w),n(a,"toJSON",V),n(a,"PRNG",e),e=e.normalized),a;function y(){return e.seed}function N(){return e.seedLength}function C(){return e.stateLength}function w(){return e.byteLength}function x(){return e.state}function k(t){e.state=t}function V(){var t={type:"PRNG"};return t.name=a.NAME,t.state=v(e.state),t.params=void 0===m?[]:[m,b],t}function F(){return f(e,m,b)}function S(t,a){return p(t)||p(a)||t>=a?NaN:f(e,t,a)}}},2499:function(t,e,a){"use strict";var n=a(2500);t.exports=n},2500:function(t,e,a){"use strict";var n=a(391).isPrimitive;t.exports=function(t){var e,a,r;if(!n(t))return!1;if(0===(e=t.length))return!1;for(r=0;r<e;r++)if((a=t.charCodeAt(r))<48||a>57)return!1;return!0}},2509:function(t,e,a){"use strict";var n=a(373),r=a(2510);n(r,"factory",a(1722)),t.exports=r},2510:function(t,e,a){"use strict";var n=a(1722)();t.exports=n},2511:function(t,e,a){"use strict";var n=a(390).isPrimitive,r=a(494);t.exports=function(t,e){return!n(t)||r(t)?new TypeError("invalid argument. First argument must be a number primitive and not `NaN`. Value: `"+t+"`."):!n(e)||r(e)?new TypeError("invalid argument. Second argument must be a number primitive and not `NaN`. Value: `"+e+"`."):t>=e?new RangeError("invalid argument. Minimum support `a` must be less than maximum support `b`. Value: `["+t+","+e+"]`."):null}},2512:function(t,e,a){"use strict";t.exports=function(t,e,a){var n=t();return a*n+(1-n)*e}},2523:function(t,e,a){"use strict";var n=a(348),r=a(347),o=a(351),i=a.n(o),s=a(0),l=a.n(s),c=a(363),d=l.a.forwardRef((function(t,e){var a=t.bsPrefix,o=t.className,s=t.striped,d=t.bordered,u=t.borderless,p=t.hover,v=t.size,h=t.variant,f=t.responsive,g=Object(r.a)(t,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),m=Object(c.a)(a,"table"),b=i()(o,m,h&&m+"-"+h,v&&m+"-"+v,s&&m+"-striped",d&&m+"-bordered",u&&m+"-borderless",p&&m+"-hover"),y=l.a.createElement("table",Object(n.a)({},g,{className:b,ref:e}));if(f){var N=m+"-responsive";return"string"==typeof f&&(N=N+"-"+f),l.a.createElement("div",{className:N},y)}return y}));e.a=d},2866:function(t,e,a){"use strict";e.a=function(t,e){var a=new String(t);return a.categories=e,a}},5651:function(t,e,a){"use strict";var n=a(443),r=a(592),o=a(1088),i="startsWith",s="".startsWith;n(n.P+n.F*a(1089)(i),"String",{startsWith:function(t){var e=o(this,t,i),a=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return s?s.call(e,n,a):e.slice(a,a+n.length)===n}})},5904:function(t,e,a){"use strict";a.r(e);a(362),a(355),a(364);var n=a(358),r=a.n(n),o=a(356),i=a.n(o),s=a(357),l=a.n(s),c=a(368),d=a.n(c),u=a(360),p=a.n(u),v=a(361),h=a.n(v),f=a(359),g=a.n(f),m=a(354),b=a.n(m),y=a(0),N=a.n(y),C=(a(346),a(386)),w=(a(475),a(402)),x=a.n(w),k=a(439),V=a(479),F=a(786),S=a(694),P=a(906),G=a(1457),M=a(419),B=a(469),O=a(651),H=a(970),A=a(560),R=a(508),L=a(1024),j=a(484),q=a(788),D=a(1100),T=a(1027),E=a(529),z=a(2509),K=a.n(z),I=a(483),W=a.n(I),J=a(559),Y=a.n(J),$=a(517),Q=a.n($),U=a(390),X=a(494),Z=a.n(X),_=a(2866),tt=a(431),et=a(2872),at=a(4407),nt=a(4404);a(321);function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=g()(t);if(e){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var ot=x()("isle:data-explorer:variable-transformer"),it=/shapes\[(\d)\]\.x0/;function st(t,e){return t-e}var lt=function(t){for(var e=[],a=0;a<t.length;a++)e.push({type:"line",x0:t[a],y0:-100,x1:t[a],y1:100,line:{color:"red",width:3}});return e},ct=function(t,e){var a=new Array(e.length);e[0]?a[0]=e[0]:a[0]="(-\u221e,".concat(t[0],")");for(var n=1;n<e.length;n++)e[n]?a[n]=e[n]:a[n]="[".concat(t[n-1],",").concat(t[n],")");var r=e.length-1;return e[r]?a[r]=e[r]:a[r]="[".concat(t[t.length-1],",\u221e)"),a},dt=r()(E.a,{raw:"x < "}),ut=r()(B.a,{md:1}),pt=r()(E.a,{raw:"\\le x <"}),vt=r()(E.a,{raw:"x \\ge"}),ht=function(t){p()(a,t);var e=rt(a);function a(t){var n;return i()(this,a),n=e.call(this,t),b()(d()(n),"onChangeHistLine",(function(t){var e=W()(t),a=it.exec(e[0]);if(a){var r=a[1],o=Q()(n.state.xBreaks);o[r]=Y()(t[e[0]],-n.state.snapDigits),o.sort(st);var i=Q()(n.state.configHist);i.layout.shapes=lt(o),n.setState({configHist:i,xBreaks:o,catNames:ct(o,n.state.customNames)})}})),b()(d()(n),"handleVariableChange",(function(t){ot("Change variable to bin...");var e={data:n.props.data,variable:t,group:null,displayDensity:!0,densityType:"Data-driven",chooseBins:!1,nBins:null},a=Object(et.b)(e);a.layout.yaxis={range:[Object(D.a)(a.data[1].y),Object(T.a)(a.data[1].y)],fixedrange:!0},a.layout.xaxis={fixedrange:!0};var r=n.props.data[t];r=r.filter((function(t){return Object(U.isPrimitive)(t)&&!Z()(t)}));var o=[Y()(Object(q.a)(r),-n.state.snapDigits)];a.layout.shapes=lt(o);var i=[!1,!1],s=ct(o,i);n.setState({activeVar:t,configHist:a,xBreaks:o,catNames:s,customNames:i})})),b()(d()(n),"handleNameChange",(function(t){n.setState({name:t.target.value})})),b()(d()(n),"handleCatNamesFactory",(function(t){return function(e){var a=Q()(n.state.catNames);a[t]=e;var r=Q()(n.state.customNames);r[t]=e,n.setState({catNames:a,customNames:r})}})),b()(d()(n),"deleteBreak",(function(t){return function(){var e=n.state.xBreaks;e.splice(t,1);var a=n.state.catNames;a.splice(t,1);var r=n.state.customNames;r.splice(t,1);var o=Q()(n.state.configHist);o.layout.shapes=lt(e),n.setState({configHist:o,catNames:a,customNames:r,xBreaks:e})}})),b()(d()(n),"makeTextInputs",(function(){var t=[],e=n.state.xBreaks,a=1===e.length;if(t.push(r()(M.a,{},"div-0",r()(B.a,{md:7},void 0,dt,r()(j.b,{inline:!0,onBlur:n.changeFactory(0),defaultValue:e[0],step:"any"})),r()(B.a,{md:4},void 0,r()(L.a,{legend:"Label 1",defaultValue:n.state.catNames[0],onChange:n.handleCatNamesFactory(0),style:{width:200}},0)),ut)),e.length>1)for(var o=0;o<e.length-1;o++){var i=n.handleCatNamesFactory(o+1);t.push(r()(M.a,{},"div-".concat(o+1),r()(B.a,{md:7},void 0,r()(j.b,{inline:!0,onBlur:n.changeFactory(o),defaultValue:e[o],step:"any"}),pt,r()(j.b,{inline:!0,onBlur:n.changeFactory(o+1),defaultValue:e[o+1],step:"any"})),r()(B.a,{md:4},void 0,r()(L.a,{legend:"Label ".concat(o+2),defaultValue:n.state.catNames[o+1],onChange:i,style:{width:200}},1+o)),r()(B.a,{md:1},void 0,r()(nt.a,{onClick:n.deleteBreak(o),style:{marginTop:"5px"},disabled:a,tooltipPlacement:"right"}))))}var s=e.length;return t.push(r()(M.a,{},"div-".concat(s),r()(B.a,{md:7},void 0,vt,r()(j.b,{inline:!0,onChange:n.changeFactory(s-1),defaultValue:e[s-1],step:"any"})),r()(B.a,{md:4},void 0,r()(L.a,{legend:"Label ".concat(s+1),defaultValue:n.state.catNames[s],onChange:n.handleCatNamesFactory(s),style:{width:200}},s)),r()(B.a,{md:1},void 0,r()(nt.a,{onClick:n.deleteBreak(s-1),style:{marginTop:"5px"},disabled:a})))),t})),b()(d()(n),"makeNewVar",(function(){var t=n.state,e=t.name,a=t.activeVar,r=t.catNames,o=t.xBreaks,i=n.props.data[a],s=Object(at.a)(i,r,o);n.props.logAction(tt.e,{name:e,variable:a,breaks:o,catNames:r}),e=Object(_.a)(e,r),n.props.onGenerate(e,s),n.props.onHide()})),b()(d()(n),"addNewBreakPoint",(function(){var t=Q()(n.state.xBreaks),e=n.props.data[n.state.activeVar];e=e.filter((function(t){return Object(U.isPrimitive)(t)&&!Z()(t)}));var a=K()(.8,1.2)*Object(q.a)(e);t.push(Y()(a,-n.state.snapDigits)),t.sort(st);var r=Q()(n.state.configHist);r.layout.shapes=lt(t);var o=n.state.customNames;o.push(!1),n.setState({xBreaks:t,configHist:r,catNames:ct(t,o)})})),b()(d()(n),"handleSnapDigitsChange",(function(t){n.setState({snapDigits:t})})),b()(d()(n),"handleKeyPress",(function(t){13===t.charCode&&n.state.name.length>=2&&n.makeNewVar()})),n.state={activeVar:null,configHist:null,xBreaks:null,name:"",catNames:null,customNames:null,snapDigits:0},n}return l()(a,[{key:"changeFactory",value:function(t){var e=this;return function(a){ot("Change break point...");var n=Q()(e.state.xBreaks);n[t]=Y()(a,-e.state.snapDigits),n.sort(st);var r=Q()(e.state.configHist);r.layout.shapes=lt(n),e.setState({configHist:r,xBreaks:n,catNames:ct(n,e.state.customNames)})}}},{key:"renderBody",value:function(){var t=this.state.configHist,e=r()(R.a,{legend:"".concat(this.props.t("variable-to-bin"),":"),defaultValue:this.state.activeVar,options:this.props.quantitative,onChange:this.handleVariableChange,style:{maxWidth:400}});return t?r()(y.Fragment,{},void 0,e,r()(C.a,{className:"insert-line-button",onClick:this.addNewBreakPoint},void 0,this.props.t("insert-break-line")),r()("p",{},void 0,this.props.t("drag-red-bars"),"(",r()(j.b,{legend:this.props.t("digits-after-comma-snap"),min:0,max:9,inline:!0,defaultValue:this.state.snapDigits,onChange:this.handleSnapDigitsChange}),")"),r()("div",{style:{height:250}},void 0,r()(O.a,{data:t.data,layout:t.layout,editable:!0,fit:!0,removeButtons:!0,legendButtons:!1,onRelayout:this.onChangeHistLine})),r()("div",{},void 0,r()(k.a,{className:"mb-2"},void 0,r()(k.a.Header,{},void 0,this.props.t("choose-category-labels"),":"),r()(k.a.Body,{},void 0,this.makeTextInputs()))),r()(S.a,{style:{width:"fit-content"}},void 0,r()(P.a,{},void 0,this.props.t("name-new-variable"),":"),r()(F.a,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),r()(G.a,{},void 0,this.props.t("new-variable-appended")))):r()(y.Fragment,{},void 0,e,r()(V.a,{variant:"info"},void 0,this.props.t("select-variable-bin")))}},{key:"render",value:function(){return r()(H.a,{cancel:".card-body",onDragStart:function(t){t.stopPropagation()},style:{zIndex:1006}},void 0,r()(A.a,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("bin-transformer-header"),footer:r()(C.a,{onClick:this.makeNewVar,disabled:this.state.name.length<2},void 0,this.props.t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,this.renderBody()))}}]),a}(y.Component);ht.defaultProps={logAction:function(){},onGenerate:function(){}};var ft=ht,gt=(a(5651),a(429)),mt=a.n(gt),bt=a(2523),yt=a(595),Nt=a(1006),Ct=a(1452),wt=a(1458),xt=a(1107),kt=a(468),Vt=a(708),Ft=a.n(Vt),St=a(477),Pt=a.n(St),Gt=a(585),Mt=a.n(Gt),Bt=a(4405),Ot=a(4406);a(322);function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=g()(t);if(e){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var At=Ft()(0,10,1),Rt=/(?:^|\n)([^\n]*)$/,Lt=/^[0-9]/,jt=N.a.forwardRef((function(t,e){var a=t.children,n=t.style,o=t.className,i=t["aria-labelledby"],s=Object(y.useState)(""),l=mt()(s,2),c=l[0],d=l[1];return N.a.createElement("div",{ref:e,style:n,className:o,"aria-labelledby":i},r()(F.a,{className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(t){return d(t.target.value)},value:c}),r()("ul",{className:"list-unstyled"},void 0,N.a.Children.toArray(a).filter((function(t){return!c||t.props.children.toLowerCase().startsWith(c)}))))})),qt=r()("p",{},void 0,"Use the formula text area below to create a new variable. The following table illustrates a few use-cases:"),Dt=r()("thead",{},void 0,r()("tr",{},void 0,r()("th",{},void 0,"Type"),r()("th",{},void 0,"Example"),r()("th",{},void 0,"Description"))),Tt=r()("td",{},void 0,"Interaction:"),Et=r()("td",{},void 0,"Transformation:"),zt=r()("td",{},void 0,"Function:"),Kt=r()("code",{},void 0,"9/5"),It=r()("code",{},void 0,"32"),Wt=r()("hr",{}),Jt=r()(Ct.a.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,"Quantitative"),Yt=r()(Ct.a.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,"Categorical"),$t=function(t){p()(a,t);var e=Ht(a);function a(t){var n;return i()(this,a),n=e.call(this,t),b()(d()(n),"handleGenerate",(function(){var t,e=n.state,a=e.code,r=e.name;Pt()(a,"return ")||(a=Mt()(a,Rt,"\nreturn $1"));try{t=Object(Bt.a)(a,n.props.data),n.props.logAction(tt.bb,{code:a,name:r}),n.props.onGenerate(r,t)}catch(o){return n.props.session.addNotification({title:"Errored",message:"Encountered the following error: "+o.message,level:"error",position:"tr"})}n.props.onHide()})),b()(d()(n),"handleNameChange",(function(t){n.setState({name:t.target.value})})),b()(d()(n),"handleCodeChange",(function(t){n.setState({code:t})})),b()(d()(n),"handleKeyPress",(function(t){13===t.charCode&&n.state.name.length>=2&&n.handleGenerate()})),b()(d()(n),"insertVarFactory",(function(t){return function(){var e=n.state.code.substring(0,n.state.selection),a="datum";e+=a+=!Pt()(t," ")&&!Pt()(t,".")&&!Lt.test(t)?".".concat(t):"['".concat(t,"']"),e+=n.state.code.substring(n.state.selection),n.setState({code:e,selection:n.state.selection+a.length})}})),b()(d()(n),"insertLiteralFactory",(function(t){return function(){var e=n.state.code.substring(0,n.state.selection),a=t;e+=a,e+=n.state.code.substring(n.state.selection),n.setState({code:e,selection:n.state.selection+a.length})}})),b()(d()(n),"insertFuncFactory",(function(t){return function(){var e=n.state.code.substring(0,n.state.selection),a=" "+t+"()";e+=a,e+=n.state.code.substring(n.state.selection),n.setState({code:e,selection:n.state.selection+a.length-1})}})),n.state={code:t.defaultCode,selection:null,name:"",showGuide:!1},n}return l()(a,[{key:"render",value:function(){var t=this,e=this.props.quantitative.map((function(e,a){return r()(Ct.a.Item,{onClick:t.insertVarFactory(e),eventKey:a},a,e)}));return r()(H.a,{cancel:".card-body",onDragStart:function(t){t.stopPropagation()},style:{zIndex:1006}},void 0,r()(A.a,{show:this.props.show,onHide:this.props.onHide,header:this.props.t("formula-transformer-header"),footer:r()(C.a,{onClick:this.handleGenerate,disabled:this.state.name.length<2},void 0,this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,r()("div",{className:"formula-transformer-body"},void 0,r()(wt.a,{headerClassName:"title",header:this.state.showGuide?"Hide Example Guide":"Show Example Guide",visible:this.state.showGuide,onClick:function(){return t.setState({showGuide:!t.state.showGuide})}},void 0,qt,r()(bt.a,{condensed:!0},void 0,Dt,r()("tbody",{},void 0,r()("tr",{},void 0,Tt,r()("td",{},void 0,r()("code",{},void 0,"datum.",this.props.quantitative[0]," * datum.",this.props.quantitative[1])),r()("td",{},void 0,"Multiply values of variables ",r()("code",{},void 0,this.props.quantitative[0])," and ",r()("code",{},void 0,this.props.quantitative[1]))),r()("tr",{},void 0,Et,r()("td",{},void 0,r()("code",{},void 0,"exp( datum.",this.props.quantitative[0]," )")),r()("td",{},void 0,"Natural exponential function of variable ",r()("code",{},void 0,this.props.quantitative[0]))),r()("tr",{},void 0,zt,r()("td",{},void 0,r()("code",{},void 0,"9/5 * ",this.props.quantitative[0]," + 32")),r()("td",{},void 0,"Multiply values of ",r()("code",{},void 0,this.props.quantitative[0])," by ",Kt," and add ",It))))),Wt,r()("div",{className:"mb-2"},void 0,r()(Nt.a,{style:{marginBottom:5}},void 0,r()(Ct.a,{className:"mr-2"},void 0,Jt,r()(Ct.a.Menu,{variant:"light",as:jt,id:"bg-nested-dropdown"},void 0,e)),r()(Ct.a,{className:"mr-2"},void 0,Yt,r()(Ct.a.Menu,{variant:"light",as:jt,id:"bg-nested-dropdown"},void 0,this.props.categorical.map((function(e,a){return r()(Ct.a.Item,{onClick:t.insertVarFactory(e),eventKey:a},a,e)})))))),r()(k.a,{className:"mb-2"},void 0,r()(k.a.Body,{},void 0,r()(Nt.a,{style:{marginBottom:5}},void 0,r()(yt.a,{size:"sm",className:"mr-2"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" < ")},void 0,"<"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" > ")},void 0,">"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" <= ")},void 0,"<="),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" >= ")},void 0,">=")),r()(yt.a,{size:"sm",className:"mr-2"},void 0,r()(kt.a,{placement:"top",tooltip:"Open parenthesis"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" ( ")},void 0,"(")),r()(kt.a,{placement:"top",tooltip:"Closing parenthesis"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" ) ")},void 0,")"))),r()(yt.a,{size:"sm",className:"mr-2"},void 0,r()(kt.a,{placement:"top",tooltip:"Addition"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" + ")},void 0,"+")),r()(kt.a,{placement:"top",tooltip:"Subtraction"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" - ")},void 0,"-")),r()(kt.a,{placement:"top",tooltip:"Multiplication"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" * ")},void 0,"*")),r()(kt.a,{placement:"top",tooltip:"Division"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" / ")},void 0,"/"))),r()(yt.a,{size:"sm",className:"mr-2"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" && ")},void 0,"and"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" || ")},void 0,"or"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" !")},void 0,"not")),r()(yt.a,{size:"sm",className:"me-2"},void 0,Ot.map((function(e,a){return r()(C.a,{variant:"light",onClick:t.insertFuncFactory(e),eventKey:a},a,e)})))),r()(Nt.a,{},void 0,r()(yt.a,{size:"sm",className:"mr-2"},void 0,At.map((function(e,a){return r()(C.a,{variant:"light",onClick:t.insertLiteralFactory("".concat(e))},a,e)})),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(".")},void 0,"."))))),r()(k.a,{className:"mb-2"},void 0,r()(k.a.Body,{},void 0,N.a.createElement(xt.a,{ref:function(e){t.textarea=e},legend:"Expression:",placeholder:"Enter formula...",value:this.state.code,onChange:this.handleCodeChange,onBlur:function(e){var a=e.target.selectionStart;t.setState({selection:a})},rows:3}))),r()(S.a,{style:{margin:8}},void 0,r()(P.a,{},void 0,this.props.t("name-new-variable"),":"),r()(F.a,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),r()(G.a,{},void 0,this.props.t("new-variable-appended"))))))}}]),a}(y.Component);$t.defaultProps={logAction:function(){},onGenerate:function(){},defaultCode:"",session:{}};var Qt=$t,Ut=a(898),Xt=a(1224),Zt=a.n(Xt),_t=a(1225),te=a.n(_t),ee=a(2499),ae=a.n(ee),ne=a(587),re=a(4408),oe=a(1361);a(323);function ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=g()(t);if(e){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var se=x()("isle:data-explorer:variable-transformer");function le(t){return t?Mt()(t,".","[dot]"):t}function ce(t){for(var e=W()(t),a=!0,n=0;n<e.length;n++)ae()(t[e[n]])||(a=!1);return a}var de=r()("th",{}),ue=function(t){p()(a,t);var e=ie(a);function a(t){var n;i()(this,a),n=e.call(this,t),b()(d()(n),"handleFirstVariableChange",(function(t){var e,a={};if(n.state.secondVar){var r=t,o=n.state.secondVar,i=n.props.data[r];e=Zt()(i,te.a);for(var s=Object(oe.a)(e,r),l=Object(oe.a)(n.state.secondFreqs,o),c=0;c<s.length;c++)for(var d=0;d<l.length;d++){var u=s[c]+"-"+l[d];a[le(u)]=u}}else{var p=n.props.data[t];e=Zt()(p,te.a);for(var v=Object(oe.a)(e,t),h=0;h<v.length;h++)a[le(v[h])]=v[h]}var f=ce(a);n.setState({firstVar:t,firstFreqs:e,nameMappings:a,onlyNumbers:f})})),b()(d()(n),"handleSecondVariableChange",(function(t){if(!t){for(var e=n.state.firstVar,a=Object(oe.a)(n.state.firstFreqs,e),r={},o=0;o<a.length;o++)r[le(a[o])]=a[o];return n.setState({secondVar:t,nameMappings:r})}for(var i={},s=n.state.firstVar,l=n.props.data[t],c=Zt()(l,te.a),d=Object(oe.a)(n.state.firstFreqs,s),u=Object(oe.a)(c,t),p=0;p<d.length;p++)for(var v=0;v<u.length;v++){var h=d[p]+"-"+u[v];i[le(h)]=h}var f=ce(i);n.setState({secondVar:t,secondFreqs:c,nameMappings:i,onlyNumbers:f})})),b()(d()(n),"handleKeyPress",(function(t){13===t.charCode&&n.state.generatedName.length>=2&&n.makeNewVar()})),b()(d()(n),"changeFreqFactory",(function(t){return function(e){var a=Q()(n.state.nameMappings);a[le(t)]=e.target.value;var r=ce(a);n.setState({nameMappings:a,onlyNumbers:r})}})),b()(d()(n),"changeContigencyFactory",(function(t,e){return function(a){var r=Q()(n.state.nameMappings);r[le(e)+"-"+le(t)]=a.target.value,n.setState({nameMappings:r})}})),b()(d()(n),"handleGeneratedNameChange",(function(t){n.setState({generatedName:t.target.value})})),b()(d()(n),"makeNewVar",(function(){se("Generating new categorical variable...");var t=n.state,e=t.firstVar,a=t.secondVar,r=t.nameMappings,o=t.castNumeric,i=Object(re.a)(e,a,r,n.props.data,o);n.props.onGenerate(n.state.generatedName,i),n.props.logAction(tt.g,{name:n.state.generatedName,firstVar:e,secondVar:a,nameMappings:r,castNumeric:o}),n.props.onHide()})),b()(d()(n),"renderFrequencyTable",(function(){var t=n.state.firstVar,e=n.props.data[t],a=Zt()(e,te.a),o=Object(oe.a)(a,t);return r()(Ut.a,{bordered:!0,style:{margin:8}},void 0,r()("thead",{},void 0,r()("tr",{},void 0,r()("th",{},void 0,n.props.t("old"),":"),o.map((function(e,a){return r()("th",{},"".concat(t,"-").concat(a,"-old"),e)})))),r()("tbody",{},void 0,r()("tr",{},void 0,r()("th",{},void 0,n.props.t("new"),":"),o.map((function(e,a){return r()("th",{},"".concat(t,"-").concat(a,"-new"),r()("input",{className:"transformer-table-input",type:"text",defaultValue:e,onChange:n.changeFreqFactory(e)}))}))),r()("tr",{style:{borderTop:"1px solid black"}},void 0,r()("th",{},void 0,n.props.t("frequencies"),":"),o.map((function(e,a){var o=n.state.firstFreqs[e];return r()("td",{},"".concat(t,"-").concat(a,"-freq"),o)})))))})),b()(d()(n),"renderContingencyTable",(function(){var t=n.state.secondVar,e=n.state.firstVar,a=n.props.data[t],o=n.props.data[e],i=Zt()(a,te.a),s=Zt()(o,te.a),l=Object(oe.a)(i,t),c=Object(oe.a)(s,e);return r()(Ut.a,{bordered:!0,style:{margin:8}},void 0,r()("tr",{},void 0,de,c.map((function(t,e){return r()("th",{},"".concat(t,"-").concat(e),t)}))),l.map((function(t,e){return r()("tr",{},"".concat(t,"-").concat(e),r()("th",{},void 0,t),c.map((function(e,a){return r()("td",{},"".concat(t,"-").concat(e,"-").concat(a),r()("input",{className:"transformer-table-input",type:"text",defaultValue:"".concat(e,"-").concat(t),onChange:n.changeContigencyFactory(t,e)}))})))})))}));for(var o=t.categorical[0],s=t.data[o],l=Zt()(s,te.a),c=Object(oe.a)(l,o),u={},p=0;p<c.length;p++)u[le(c[p])]=c[p];return n.state={generatedName:"",firstVar:o,firstFreqs:l,nameMappings:u,secondVar:null,secondFreqs:null,castNumeric:!1,onlyNumbers:!1},n}return l()(a,[{key:"renderTable",value:function(){return this.state.firstVar&&this.state.secondVar?this.renderContingencyTable():this.state.firstVar||this.state.secondVar?this.renderFrequencyTable():null}},{key:"render",value:function(){var t=this;return r()(H.a,{cancel:".card-body",onDragStart:function(t){t.stopPropagation()},style:{zIndex:1006}},void 0,r()(A.a,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("categorical-transformer-header"),footer:r()(C.a,{onClick:this.makeNewVar,disabled:this.state.generatedName.length<2},void 0,this.props.t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,r()(M.a,{},void 0,r()(B.a,{md:4},void 0,r()(R.a,{legend:"".concat(this.props.t("first-variable"),":"),defaultValue:this.state.firstVar||"",options:this.props.categorical,onChange:this.handleFirstVariableChange})),r()(B.a,{md:4},void 0,r()(R.a,{clearable:!0,legend:"".concat(this.props.t("optional-second-variable"),":"),defaultValue:this.state.secondVar||"",options:this.props.categorical,onChange:this.handleSecondVariableChange}))),r()(M.a,{style:{overflowX:"auto",width:"100%"}},void 0,this.renderTable()),r()(M.a,{},void 0,r()(kt.a,{tooltip:this.props.t("treat-labels-as-numbers-tooltip")},void 0,r()(ne.a,{legend:this.props.t("treat-labels-as-numbers"),defaultValue:!1,disabled:!this.state.onlyNumbers,onChange:function(){t.setState({castNumeric:!t.state.castNumeric})}}))),r()(M.a,{},void 0,r()(S.a,{style:{margin:8}},void 0,r()(P.a,{},void 0,this.props.t("name-new-variable"),":"),r()(F.a,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),r()(G.a,{},void 0,this.props.t("new-variable-appended"))))))}}]),a}(y.Component);ue.defaultProps={logAction:function(){}};var pe=ue,ve=(a(1123),a(1038)),he=a.n(ve),fe=a(1344),ge=a.n(fe);function me(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=g()(t);if(e){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var be=x()("isle:data-explorer:group-transformer"),ye=function(t){p()(a,t);var e=me(a);function a(t){var n;return i()(this,a),n=e.call(this,t),b()(d()(n),"handleGeneratedNameChange",(function(t){n.setState({generatedName:t.target.value})})),b()(d()(n),"handleGroupNumberChange",(function(t){for(var e=new Array(t).fill(1/t),a=new Array(t),r=0;r<a.length;r++)a[r]="Group ".concat(r+1);n.setState({groupProbs:e,labels:a,nGroups:t})})),b()(d()(n),"handleKeyPress",(function(t){if(13===t.charCode){for(var e=0,a=0;a<n.state.groupProbs.length;a++)e+=n.state.groupProbs[a];n.state.generatedName.length>2&&ge()(e,1)<=15e-9&&n.makeNewVar()}})),b()(d()(n),"makeNewVar",(function(){be("Generating new categorical variable...");var t=W()(n.props.data),e=n.props.data[t[0]].length,a=he()(n.state.labels,{size:e,probs:n.state.groupProbs,replace:!0});n.props.onGenerate(n.state.generatedName,a),n.props.logAction(tt.m,{name:n.state.generatedName,labels:n.state.labels,groupProbs:n.state.groupProbs}),n.props.onHide()})),n.state={generatedName:"",nGroups:2,groupProbs:[.5,.5],labels:["Group 1","Group 2"]},n}return l()(a,[{key:"renderTable",value:function(){for(var t=this,e=new Array(this.state.nGroups),a=function(a){e[a]=r()(M.a,{},a,r()(B.a,{},void 0,r()(L.a,{legend:"Label for Group ".concat(a+1),defaultValue:t.state.labels[a],onChange:function(e){var n=t.state.labels.slice();n[a]=e,t.setState({labels:n})}})),r()(B.a,{},void 0,r()(j.b,{legend:"Group Proportion",onChange:function(e){var n=t.state.groupProbs.slice();n[a]=e,t.setState({groupProbs:n})},defaultValue:t.state.groupProbs[a],step:.01,min:0,max:1,numbersOnly:!1})))},n=0;n<e.length;n++)a(n);return r()(y.Fragment,{},void 0,e,r()("p",{},void 0,this.props.t("proportions-sum-one")))}},{key:"render",value:function(){for(var t=0,e=0;e<this.state.groupProbs.length;e++)t+=this.state.groupProbs[e];var a=this.state.generatedName.length>2&&ge()(t,1)<=15e-9;return r()(H.a,{cancel:".card-body",onDragStart:function(t){t.stopPropagation()},style:{zIndex:1006}},void 0,r()(A.a,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("group-transformer-header"),footer:r()(C.a,{onClick:this.makeNewVar,disabled:!a},void 0,this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,r()(M.a,{},void 0,r()(B.a,{},void 0,r()(j.b,{legend:this.props.t("number-of-groups"),onChange:this.handleGroupNumberChange,defaultValue:this.state.nGroups,step:1,min:1,max:99}))),this.renderTable(),r()(M.a,{},void 0,r()(S.a,{style:{margin:8}},void 0,r()(P.a,{},void 0,this.props.t("name-new-variable"),":"),r()(F.a,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),r()(G.a,{},void 0,this.props.t("new-variable-appended"))))))}}]),a}(y.Component);ye.defaultProps={logAction:function(){}};var Ne=ye;function Ce(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=g()(t);if(e){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var we=function(t){p()(a,t);var e=Ce(a);function a(t){var n;return i()(this,a),n=e.call(this,t),b()(d()(n),"renderFormulaModal",(function(){var t="formula"===n.state.active;return t&&n.props.data?r()(Qt,{show:t,onHide:n.toggleFormulaModal,categorical:n.props.categorical,quantitative:n.props.quantitative,data:n.props.data,defaultCode:n.props.defaultCode,logAction:n.props.logAction,onGenerate:n.props.onGenerate,session:n.props.session,t:n.props.t}):null})),b()(d()(n),"renderBinModal",(function(){var t="bin"===n.state.active;return t&&n.props.data?r()(ft,{show:t,onHide:n.toggleBinModal,quantitative:n.props.quantitative,logAction:n.props.logAction,onGenerate:n.props.onGenerate,data:n.props.data,t:n.props.t}):null})),b()(d()(n),"renderCategoricalModal",(function(){var t="categorical"===n.state.active;return t&&n.props.data?r()(pe,{show:t,onHide:n.toggleCategoricalModal,categorical:n.props.categorical,logAction:n.props.logAction,onGenerate:n.props.onGenerate,data:n.props.data,t:n.props.t}):null})),b()(d()(n),"renderGroupModal",(function(){var t="group"===n.state.active;return t&&n.props.data?r()(Ne,{show:t,onHide:n.toggleGroupModal,logAction:n.props.logAction,onGenerate:n.props.onGenerate,data:n.props.data,t:n.props.t}):null})),b()(d()(n),"handleActive",(function(){n.props.onActive(n.state.active)})),b()(d()(n),"toggleFormulaModal",(function(){n.setState({active:"formula"===n.state.active?null:"formula"},n.handleActive)})),b()(d()(n),"toggleBinModal",(function(){n.setState({active:"bin"===n.state.active?null:"bin"},n.handleActive)})),b()(d()(n),"toggleCategoricalModal",(function(){n.setState({active:"categorical"===n.state.active?null:"categorical"},n.handleActive)})),b()(d()(n),"toggleGroupModal",(function(){n.setState({active:"group"===n.state.active?null:"group"},n.handleActive)})),n.state={active:null},n}return l()(a,[{key:"render",value:function(){return r()(y.Fragment,{},void 0,r()("div",{className:"well",style:{padding:15,margin:15}},void 0,r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleFormulaModal,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,this.props.t("interactions-functions"))),r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleBinModal,disabled:0===this.props.quantitative.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,this.props.t("bin-quantitative"))),r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleCategoricalModal,disabled:0===this.props.categorical.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,this.props.t("rename-or-combine"))),r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleGroupModal,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,this.props.t("create-groups")))),this.renderBinModal(),this.renderFormulaModal(),this.renderCategoricalModal(),this.renderGroupModal())}}]),a}(y.Component);we.defaultProps={logAction:function(){},onActive:function(){},onGenerate:function(){},defaultCode:"",session:{}};e.default=we}}]);