/*! For license information please see 356.78d3b099.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[356],{1e3:function(e,t,a){"use strict";var n=a(344),r=a(345),o=a(348),i=a.n(o),s=a(0),l=a.n(s),c=a(359),d=l.a.forwardRef((function(e,t){var a=e.bsPrefix,o=e.className,s=Object(r.a)(e,["bsPrefix","className"]),d=Object(c.a)(a,"btn-toolbar");return l.a.createElement("div",Object(n.a)({},s,{ref:t,className:i()(o,d)}))}));d.displayName="ButtonToolbar",d.defaultProps={role:"toolbar"},t.a=d},1714:function(e,t,a){"use strict";var n=a(369),r=a(636),o=a(685),i=a(417),s=a(443),l=a(381),c=a(390),d=a(618),u=a(833).factory,v=a(346),p=a(686),h=a(2514),f=a(2515);e.exports=function(){var e,t,a,g,m,b;if(0===arguments.length)t=u();else if(1===arguments.length){if(!i(e=arguments[0]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(l(e,"prng")){if(!s(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else{if(g=h(m=arguments[0],b=arguments[1]))throw g;if(arguments.length>2){if(!i(e=arguments[2]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(l(e,"prng")){if(!s(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else t=u()}return n(a=void 0===m?F:S,"NAME","uniform"),e&&e.prng?(n(a,"seed",null),n(a,"seedLength",null),o(a,"state",c(null),d),n(a,"stateLength",null),n(a,"byteLength",null),n(a,"toJSON",c(null)),n(a,"PRNG",t)):(r(a,"seed",y),r(a,"seedLength",N),o(a,"state",x,k),r(a,"stateLength",C),r(a,"byteLength",w),n(a,"toJSON",V),n(a,"PRNG",t),t=t.normalized),a;function y(){return t.seed}function N(){return t.seedLength}function C(){return t.stateLength}function w(){return t.byteLength}function x(){return t.state}function k(e){t.state=e}function V(){var e={type:"PRNG"};return e.name=a.NAME,e.state=p(t.state),e.params=void 0===m?[]:[m,b],e}function S(){return f(t,m,b)}function F(e,a){return v(e)||v(a)||e>=a?NaN:f(t,e,a)}}},2495:function(e,t,a){"use strict";var n=a(2496);e.exports=n},2496:function(e,t,a){"use strict";var n=a(386).isPrimitive;e.exports=function(e){var t,a,r;if(!n(e))return!1;if(0===(t=e.length))return!1;for(r=0;r<t;r++)if((a=e.charCodeAt(r))<48||a>57)return!1;return!0}},2512:function(e,t,a){"use strict";var n=a(369),r=a(2513);n(r,"factory",a(1714)),e.exports=r},2513:function(e,t,a){"use strict";var n=a(1714)();e.exports=n},2514:function(e,t,a){"use strict";var n=a(385).isPrimitive,r=a(485);e.exports=function(e,t){return!n(e)||r(e)?new TypeError("invalid argument. First argument must be a number primitive and not `NaN`. Value: `"+e+"`."):!n(t)||r(t)?new TypeError("invalid argument. Second argument must be a number primitive and not `NaN`. Value: `"+t+"`."):e>=t?new RangeError("invalid argument. Minimum support `a` must be less than maximum support `b`. Value: `["+e+","+t+"]`."):null}},2515:function(e,t,a){"use strict";e.exports=function(e,t,a){var n=e();return a*n+(1-n)*t}},2526:function(e,t,a){"use strict";var n=a(344),r=a(345),o=a(348),i=a.n(o),s=a(0),l=a.n(s),c=a(359),d=l.a.forwardRef((function(e,t){var a=e.bsPrefix,o=e.className,s=e.striped,d=e.bordered,u=e.borderless,v=e.hover,p=e.size,h=e.variant,f=e.responsive,g=Object(r.a)(e,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),m=Object(c.a)(a,"table"),b=i()(o,m,h&&m+"-"+h,p&&m+"-"+p,s&&m+"-striped",d&&m+"-bordered",u&&m+"-borderless",v&&m+"-hover"),y=l.a.createElement("table",Object(n.a)({},g,{className:b,ref:t}));if(f){var N=m+"-responsive";return"string"==typeof f&&(N=N+"-"+f),l.a.createElement("div",{className:N},y)}return y}));t.a=d},2866:function(e,t,a){"use strict";t.a=function(e,t){var a=new String(e);return a.categories=t,a}},5639:function(e,t,a){"use strict";var n=a(430),r=a(586),o=a(1083),i="startsWith",s="".startsWith;n(n.P+n.F*a(1084)(i),"String",{startsWith:function(e){var t=o(this,e,i),a=r(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return s?s.call(t,n,a):t.slice(a,a+n.length)===n}})},5883:function(e,t,a){"use strict";a.r(t);a(358),a(351),a(360);var n=a(354),r=a.n(n),o=a(352),i=a.n(o),s=a(353),l=a.n(s),c=a(364),d=a.n(c),u=a(356),v=a.n(u),p=a(357),h=a.n(p),f=a(355),g=a.n(f),m=a(350),b=a.n(m),y=a(0),N=a.n(y),C=(a(342),a(384)),w=(a(468),a(398)),x=a.n(w),k=a(427),V=a(477),S=a(834),F=a(695),P=a(955),G=a(1444),B=a(413),M=a(458),O=a(647),H=a(986),R=a(558),q=a(507),A=a(1018),T=a(474),L=a(771),j=a(1093),D=a(1021),E=a(524),z=a(2512),I=a.n(z),K=a(473),W=a.n(K),J=a(553),Y=a.n(J),$=a(512),Q=a.n($),U=a(385),X=a(485),Z=a.n(X),_=a(2866),ee=a(419),te=a(2871),ae=a(4401),ne=a(4398);a(320);function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var oe=x()("isle:data-explorer:variable-transformer"),ie=/shapes\[(\d)\]\.x0/;function se(e,t){return e-t}var le=function(e){for(var t=[],a=0;a<e.length;a++)t.push({type:"line",x0:e[a],y0:-100,x1:e[a],y1:100,line:{color:"red",width:3}});return t},ce=function(e,t){var a=new Array(t.length);t[0]?a[0]=t[0]:a[0]="(-\u221e,".concat(e[0],")");for(var n=1;n<t.length;n++)t[n]?a[n]=t[n]:a[n]="[".concat(e[n-1],",").concat(e[n],")");var r=t.length-1;return t[r]?a[r]=t[r]:a[r]="[".concat(e[e.length-1],",\u221e)"),a},de=r()(E.a,{raw:"x < "}),ue=r()(M.a,{md:1}),ve=r()(E.a,{raw:"\\le x <"}),pe=r()(E.a,{raw:"x \\ge"}),he=r()(V.a,{variant:"info"},void 0,"Please select a variable to bin..."),fe=r()(k.a.Header,{},void 0,"Choose categorical labels for interval bins:"),ge=r()(P.a,{},void 0,"Name of new variable:"),me=r()(G.a,{},void 0,"The new variable will be appended as a new column to the data table."),be=function(e){v()(a,e);var t=re(a);function a(e){var n;return i()(this,a),n=t.call(this,e),b()(d()(n),"onChangeHistLine",(function(e){var t=W()(e),a=ie.exec(t[0]);if(a){var r=a[1],o=Q()(n.state.xBreaks);o[r]=Y()(e[t[0]],-n.state.snapDigits),o.sort(se);var i=Q()(n.state.configHist);i.layout.shapes=le(o),n.setState({configHist:i,xBreaks:o,catNames:ce(o,n.state.customNames)})}})),b()(d()(n),"handleVariableChange",(function(e){oe("Change variable to bin...");var t={data:n.props.data,variable:e,group:null,displayDensity:!0,densityType:"Data-driven",chooseBins:!1,nBins:null},a=Object(te.b)(t);a.layout.yaxis={range:[Object(j.a)(a.data[1].y),Object(D.a)(a.data[1].y)],fixedrange:!0},a.layout.xaxis={fixedrange:!0};var r=n.props.data[e];r=r.filter((function(e){return Object(U.isPrimitive)(e)&&!Z()(e)}));var o=[Y()(Object(L.a)(r),-n.state.snapDigits)];a.layout.shapes=le(o);var i=[!1,!1],s=ce(o,i);n.setState({activeVar:e,configHist:a,xBreaks:o,catNames:s,customNames:i})})),b()(d()(n),"handleNameChange",(function(e){n.setState({name:e.target.value})})),b()(d()(n),"handleCatNamesFactory",(function(e){return function(t){var a=Q()(n.state.catNames);a[e]=t;var r=Q()(n.state.customNames);r[e]=t,n.setState({catNames:a,customNames:r})}})),b()(d()(n),"deleteBreak",(function(e){return function(){var t=n.state.xBreaks;t.splice(e,1);var a=n.state.catNames;a.splice(e,1);var r=n.state.customNames;r.splice(e,1);var o=Q()(n.state.configHist);o.layout.shapes=le(t),n.setState({configHist:o,catNames:a,customNames:r,xBreaks:t})}})),b()(d()(n),"makeTextInputs",(function(){var e=[],t=n.state.xBreaks,a=1===t.length;if(e.push(r()(B.a,{},"div-0",r()(M.a,{md:7},void 0,de,r()(T.b,{inline:!0,onBlur:n.changeFactory(0),defaultValue:t[0],step:"any"})),r()(M.a,{md:4},void 0,r()(A.a,{legend:"Label 1",defaultValue:n.state.catNames[0],onChange:n.handleCatNamesFactory(0),style:{width:200}},0)),ue)),t.length>1)for(var o=0;o<t.length-1;o++){var i=n.handleCatNamesFactory(o+1);e.push(r()(B.a,{},"div-".concat(o+1),r()(M.a,{md:7},void 0,r()(T.b,{inline:!0,onBlur:n.changeFactory(o),defaultValue:t[o],step:"any"}),ve,r()(T.b,{inline:!0,onBlur:n.changeFactory(o+1),defaultValue:t[o+1],step:"any"})),r()(M.a,{md:4},void 0,r()(A.a,{legend:"Label ".concat(o+2),defaultValue:n.state.catNames[o+1],onChange:i,style:{width:200}},1+o)),r()(M.a,{md:1},void 0,r()(ne.a,{onClick:n.deleteBreak(o),style:{marginTop:"5px"},disabled:a,tooltipPlacement:"right"}))))}var s=t.length;return e.push(r()(B.a,{},"div-".concat(s),r()(M.a,{md:7},void 0,pe,r()(T.b,{inline:!0,onChange:n.changeFactory(s-1),defaultValue:t[s-1],step:"any"})),r()(M.a,{md:4},void 0,r()(A.a,{legend:"Label ".concat(s+1),defaultValue:n.state.catNames[s],onChange:n.handleCatNamesFactory(s),style:{width:200}},s)),r()(M.a,{md:1},void 0,r()(ne.a,{onClick:n.deleteBreak(s-1),style:{marginTop:"5px"},disabled:a})))),e})),b()(d()(n),"makeNewVar",(function(){var e=n.state,t=e.name,a=e.activeVar,r=e.catNames,o=e.xBreaks,i=n.props.data[a],s=Object(ae.a)(i,r,o);n.props.logAction(ee.e,{name:t,variable:a,breaks:o,catNames:r}),t=Object(_.a)(t,r),n.props.onGenerate(t,s),n.props.onHide()})),b()(d()(n),"addNewBreakPoint",(function(){var e=Q()(n.state.xBreaks),t=n.props.data[n.state.activeVar];t=t.filter((function(e){return Object(U.isPrimitive)(e)&&!Z()(e)}));var a=I()(.8,1.2)*Object(L.a)(t);e.push(Y()(a,-n.state.snapDigits)),e.sort(se);var r=Q()(n.state.configHist);r.layout.shapes=le(e);var o=n.state.customNames;o.push(!1),n.setState({xBreaks:e,configHist:r,catNames:ce(e,o)})})),b()(d()(n),"handleSnapDigitsChange",(function(e){n.setState({snapDigits:e})})),b()(d()(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.name.length>=2&&n.makeNewVar()})),n.state={activeVar:null,configHist:null,xBreaks:null,name:"",catNames:null,customNames:null,snapDigits:0},n}return l()(a,[{key:"changeFactory",value:function(e){var t=this;return function(a){oe("Change break point...");var n=Q()(t.state.xBreaks);n[e]=Y()(a,-t.state.snapDigits),n.sort(se);var r=Q()(t.state.configHist);r.layout.shapes=le(n),t.setState({configHist:r,xBreaks:n,catNames:ce(n,t.state.customNames)})}}},{key:"renderBody",value:function(){var e=this.state.configHist,t=r()(q.a,{legend:"Variable to bin:",defaultValue:this.state.activeVar,options:this.props.quantitative,onChange:this.handleVariableChange,style:{maxWidth:400}});return e?r()(y.Fragment,{},void 0,t,r()(C.a,{className:"insert-line-button",onClick:this.addNewBreakPoint},void 0,"Insert break line"),r()("p",{},void 0,"Drag the red vertical bar(s) to change breakpoints (",r()(T.b,{legend:"digits after comma to snap to",min:0,max:9,inline:!0,defaultValue:this.state.snapDigits,onChange:this.handleSnapDigitsChange}),")"),r()("div",{style:{height:250}},void 0,r()(O.a,{data:e.data,layout:e.layout,editable:!0,fit:!0,removeButtons:!0,legendButtons:!1,onRelayout:this.onChangeHistLine})),r()("div",{},void 0,r()(k.a,{className:"mb-2"},void 0,fe,r()(k.a.Body,{},void 0,this.makeTextInputs()))),r()(F.a,{style:{width:"fit-content"}},void 0,ge,r()(S.a,{type:"text",placeholder:"Select name...",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),me)):r()(y.Fragment,{},void 0,t,he)}},{key:"render",value:function(){return r()(H.a,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,r()(R.a,{onHide:this.props.onHide,show:this.props.show,header:"Create new variable by binning a quantitative variable into categories",footer:r()(C.a,{onClick:this.makeNewVar,disabled:this.state.name.length<2},void 0,"Create new variable"),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,this.renderBody()))}}]),a}(y.Component);be.defaultProps={logAction:function(){},onGenerate:function(){}};var ye=be,Ne=(a(5639),a(421)),Ce=a.n(Ne),we=a(2526),xe=a(587),ke=a(1e3),Ve=a(1440),Se=a(1445),Fe=a(1144),Pe=a(465),Ge=a(701),Be=a.n(Ge),Me=a(469),Oe=a.n(Me),He=a(578),Re=a.n(He),qe=a(4399),Ae=a(4400);a(321);function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var Le=Be()(0,10,1),je=/(?:^|\n)([^\n]*)$/,De=/^[0-9]/,Ee=N.a.forwardRef((function(e,t){var a=e.children,n=e.style,o=e.className,i=e["aria-labelledby"],s=Object(y.useState)(""),l=Ce()(s,2),c=l[0],d=l[1];return N.a.createElement("div",{ref:t,style:n,className:o,"aria-labelledby":i},r()(S.a,{className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return d(e.target.value)},value:c}),r()("ul",{className:"list-unstyled"},void 0,N.a.Children.toArray(a).filter((function(e){return!c||e.props.children.toLowerCase().startsWith(c)}))))})),ze=r()("p",{},void 0,"Use the formula text area below to create a new variable. The following table illustrates a few use-cases:"),Ie=r()("thead",{},void 0,r()("tr",{},void 0,r()("th",{},void 0,"Type"),r()("th",{},void 0,"Example"),r()("th",{},void 0,"Description"))),Ke=r()("td",{},void 0,"Interaction:"),We=r()("td",{},void 0,"Transformation:"),Je=r()("td",{},void 0,"Function:"),Ye=r()("code",{},void 0,"9/5"),$e=r()("code",{},void 0,"32"),Qe=r()("hr",{}),Ue=r()(Ve.a.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,"Quantitative"),Xe=r()(Ve.a.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,"Categorical"),Ze=r()(P.a,{},void 0,"Name of new variable:"),_e=r()(G.a,{},void 0,"The new variable will be appended as a new column to the data table."),et=function(e){v()(a,e);var t=Te(a);function a(e){var n;return i()(this,a),n=t.call(this,e),b()(d()(n),"handleGenerate",(function(){var e,t=n.state,a=t.code,r=t.name;Oe()(a,"return ")||(a=Re()(a,je,"\nreturn $1"));try{e=Object(qe.a)(a,n.props.data),n.props.logAction(ee.bb,{code:a,name:r}),n.props.onGenerate(r,e)}catch(o){return n.props.session.addNotification({title:"Errored",message:"Encountered the following error: "+o.message,level:"error",position:"tr"})}n.props.onHide()})),b()(d()(n),"handleNameChange",(function(e){n.setState({name:e.target.value})})),b()(d()(n),"handleCodeChange",(function(e){n.setState({code:e})})),b()(d()(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.name.length>=2&&n.handleGenerate()})),b()(d()(n),"insertVarFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a="datum";t+=a+=!Oe()(e," ")&&!Oe()(e,".")&&!De.test(e)?".".concat(e):"['".concat(e,"']"),t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),b()(d()(n),"insertLiteralFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=e;t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),b()(d()(n),"insertFuncFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=" "+e+"()";t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length-1})}})),n.state={code:e.defaultCode,selection:null,name:"",showGuide:!1},n}return l()(a,[{key:"render",value:function(){var e=this,t=this.props.quantitative.map((function(t,a){return r()(Ve.a.Item,{onClick:e.insertVarFactory(t),eventKey:a},a,t)}));return r()(H.a,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,r()(R.a,{show:this.props.show,onHide:this.props.onHide,header:"Create a new variable as a function of existing variables",footer:r()(C.a,{onClick:this.handleGenerate,disabled:this.state.name.length<2},void 0,"Create new variable"),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,r()("div",{className:"formula-transformer-body"},void 0,r()(Se.a,{headerClassName:"title",header:this.state.showGuide?"Hide Example Guide":"Show Example Guide",visible:this.state.showGuide,onClick:function(){return e.setState({showGuide:!e.state.showGuide})}},void 0,ze,r()(we.a,{condensed:!0},void 0,Ie,r()("tbody",{},void 0,r()("tr",{},void 0,Ke,r()("td",{},void 0,r()("code",{},void 0,"datum.",this.props.quantitative[0]," * datum.",this.props.quantitative[1])),r()("td",{},void 0,"Multiply values of variables ",r()("code",{},void 0,this.props.quantitative[0])," and ",r()("code",{},void 0,this.props.quantitative[1]))),r()("tr",{},void 0,We,r()("td",{},void 0,r()("code",{},void 0,"exp( datum.",this.props.quantitative[0]," )")),r()("td",{},void 0,"Natural exponential function of variable ",r()("code",{},void 0,this.props.quantitative[0]))),r()("tr",{},void 0,Je,r()("td",{},void 0,r()("code",{},void 0,"9/5 * ",this.props.quantitative[0]," + 32")),r()("td",{},void 0,"Multiply values of ",r()("code",{},void 0,this.props.quantitative[0])," by ",Ye," and add ",$e))))),Qe,r()("div",{className:"mb-2"},void 0,r()(ke.a,{style:{marginBottom:5}},void 0,r()(Ve.a,{className:"mr-2"},void 0,Ue,r()(Ve.a.Menu,{variant:"light",as:Ee,id:"bg-nested-dropdown"},void 0,t)),r()(Ve.a,{className:"mr-2"},void 0,Xe,r()(Ve.a.Menu,{variant:"light",as:Ee,id:"bg-nested-dropdown"},void 0,this.props.categorical.map((function(t,a){return r()(Ve.a.Item,{onClick:e.insertVarFactory(t),eventKey:a},a,t)})))))),r()(k.a,{className:"mb-2"},void 0,r()(k.a.Body,{},void 0,r()(ke.a,{style:{marginBottom:5}},void 0,r()(xe.a,{size:"sm",className:"mr-2"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" < ")},void 0,"<"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" > ")},void 0,">"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" <= ")},void 0,"<="),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" >= ")},void 0,">=")),r()(xe.a,{size:"sm",className:"mr-2"},void 0,r()(Pe.a,{placement:"top",tooltip:"Open parenthesis"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" ( ")},void 0,"(")),r()(Pe.a,{placement:"top",tooltip:"Closing parenthesis"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" ) ")},void 0,")"))),r()(xe.a,{size:"sm",className:"mr-2"},void 0,r()(Pe.a,{placement:"top",tooltip:"Addition"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" + ")},void 0,"+")),r()(Pe.a,{placement:"top",tooltip:"Subtraction"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" - ")},void 0,"-")),r()(Pe.a,{placement:"top",tooltip:"Multiplication"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" * ")},void 0,"*")),r()(Pe.a,{placement:"top",tooltip:"Division"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" / ")},void 0,"/"))),r()(xe.a,{size:"sm",className:"mr-2"},void 0,r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" && ")},void 0,"and"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" || ")},void 0,"or"),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(" !")},void 0,"not")),r()(xe.a,{size:"sm",className:"me-2"},void 0,Ae.map((function(t,a){return r()(C.a,{variant:"light",onClick:e.insertFuncFactory(t),eventKey:a},a,t)})))),r()(ke.a,{},void 0,r()(xe.a,{size:"sm",className:"mr-2"},void 0,Le.map((function(t,a){return r()(C.a,{variant:"light",onClick:e.insertLiteralFactory("".concat(t))},a,t)})),r()(C.a,{variant:"light",onClick:this.insertLiteralFactory(".")},void 0,"."))))),r()(k.a,{className:"mb-2"},void 0,r()(k.a.Body,{},void 0,N.a.createElement(Fe.a,{ref:function(t){e.textarea=t},legend:"Expression:",placeholder:"Enter formula...",value:this.state.code,onChange:this.handleCodeChange,onBlur:function(t){var a=t.target.selectionStart;e.setState({selection:a})},rows:3}))),r()(F.a,{style:{margin:8}},void 0,Ze,r()(S.a,{type:"text",placeholder:"Select name...",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),_e))))}}]),a}(y.Component);et.defaultProps={logAction:function(){},onGenerate:function(){},defaultCode:"",session:{}};var tt=et,at=a(894),nt=a(1214),rt=a.n(nt),ot=a(1215),it=a.n(ot),st=a(2495),lt=a.n(st),ct=a(581),dt=a(4402),ut=a(1351);a(322);function vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var pt=x()("isle:data-explorer:variable-transformer");function ht(e){return e?Re()(e,".","[dot]"):e}function ft(e){for(var t=W()(e),a=!0,n=0;n<t.length;n++)lt()(e[t[n]])||(a=!1);return a}var gt=r()("th",{},void 0,"Old:"),mt=r()("th",{},void 0,"New:"),bt=r()("th",{},void 0,"Frequencies:"),yt=r()("th",{}),Nt=r()(P.a,{},void 0,"Name of new variable:"),Ct=r()(G.a,{},void 0,"The new variable will be appended as a new column to the data table."),wt=function(e){v()(a,e);var t=vt(a);function a(e){var n;i()(this,a),n=t.call(this,e),b()(d()(n),"handleFirstVariableChange",(function(e){var t,a={};if(n.state.secondVar){var r=e,o=n.state.secondVar,i=n.props.data[r];t=rt()(i,it.a);for(var s=Object(ut.a)(t,r),l=Object(ut.a)(n.state.secondFreqs,o),c=0;c<s.length;c++)for(var d=0;d<l.length;d++){var u=s[c]+"-"+l[d];a[ht(u)]=u}}else{var v=n.props.data[e];t=rt()(v,it.a);for(var p=Object(ut.a)(t,e),h=0;h<p.length;h++)a[ht(p[h])]=p[h]}var f=ft(a);n.setState({firstVar:e,firstFreqs:t,nameMappings:a,onlyNumbers:f})})),b()(d()(n),"handleSecondVariableChange",(function(e){if(!e){for(var t=n.state.firstVar,a=Object(ut.a)(n.state.firstFreqs,t),r={},o=0;o<a.length;o++)r[ht(a[o])]=a[o];return n.setState({secondVar:e,nameMappings:r})}for(var i={},s=n.state.firstVar,l=n.props.data[e],c=rt()(l,it.a),d=Object(ut.a)(n.state.firstFreqs,s),u=Object(ut.a)(c,e),v=0;v<d.length;v++)for(var p=0;p<u.length;p++){var h=d[v]+"-"+u[p];i[ht(h)]=h}var f=ft(i);n.setState({secondVar:e,secondFreqs:c,nameMappings:i,onlyNumbers:f})})),b()(d()(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.generatedName.length>=2&&n.makeNewVar()})),b()(d()(n),"changeFreqFactory",(function(e){return function(t){var a=Q()(n.state.nameMappings);a[ht(e)]=t.target.value;var r=ft(a);n.setState({nameMappings:a,onlyNumbers:r})}})),b()(d()(n),"changeContigencyFactory",(function(e,t){return function(a){var r=Q()(n.state.nameMappings);r[ht(t)+"-"+ht(e)]=a.target.value,n.setState({nameMappings:r})}})),b()(d()(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),b()(d()(n),"makeNewVar",(function(){pt("Generating new categorical variable...");var e=n.state,t=e.firstVar,a=e.secondVar,r=e.nameMappings,o=e.castNumeric,i=Object(dt.a)(t,a,r,n.props.data,o);n.props.onGenerate(n.state.generatedName,i),n.props.logAction(ee.g,{name:n.state.generatedName,firstVar:t,secondVar:a,nameMappings:r,castNumeric:o}),n.props.onHide()})),b()(d()(n),"renderFrequencyTable",(function(){var e=n.state.firstVar,t=n.props.data[e],a=rt()(t,it.a),o=Object(ut.a)(a,e);return r()(at.a,{bordered:!0,style:{margin:8}},void 0,r()("thead",{},void 0,r()("tr",{},void 0,gt,o.map((function(t,a){return r()("th",{},"".concat(e,"-").concat(a,"-old"),t)})))),r()("tbody",{},void 0,r()("tr",{},void 0,mt,o.map((function(t,a){return r()("th",{},"".concat(e,"-").concat(a,"-new"),r()("input",{className:"transformer-table-input",type:"text",defaultValue:t,onChange:n.changeFreqFactory(t)}))}))),r()("tr",{style:{borderTop:"1px solid black"}},void 0,bt,o.map((function(t,a){var o=n.state.firstFreqs[t];return r()("td",{},"".concat(e,"-").concat(a,"-freq"),o)})))))})),b()(d()(n),"renderContingencyTable",(function(){var e=n.state.secondVar,t=n.state.firstVar,a=n.props.data[e],o=n.props.data[t],i=rt()(a,it.a),s=rt()(o,it.a),l=Object(ut.a)(i,e),c=Object(ut.a)(s,t);return r()(at.a,{bordered:!0,style:{margin:8}},void 0,r()("tr",{},void 0,yt,c.map((function(e,t){return r()("th",{},"".concat(e,"-").concat(t),e)}))),l.map((function(e,t){return r()("tr",{},"".concat(e,"-").concat(t),r()("th",{},void 0,e),c.map((function(t,a){return r()("td",{},"".concat(e,"-").concat(t,"-").concat(a),r()("input",{className:"transformer-table-input",type:"text",defaultValue:"".concat(t,"-").concat(e),onChange:n.changeContigencyFactory(e,t)}))})))})))}));for(var o=e.categorical[0],s=e.data[o],l=rt()(s,it.a),c=Object(ut.a)(l,o),u={},v=0;v<c.length;v++)u[ht(c[v])]=c[v];return n.state={generatedName:"",firstVar:o,firstFreqs:l,nameMappings:u,secondVar:null,secondFreqs:null,castNumeric:!1,onlyNumbers:!1},n}return l()(a,[{key:"renderTable",value:function(){return this.state.firstVar&&this.state.secondVar?this.renderContingencyTable():this.state.firstVar||this.state.secondVar?this.renderFrequencyTable():null}},{key:"render",value:function(){var e=this;return r()(H.a,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,r()(R.a,{onHide:this.props.onHide,show:this.props.show,header:"Create new variable by renaming or combining categories",footer:r()(C.a,{onClick:this.makeNewVar,disabled:this.state.generatedName.length<2},void 0,"Create new variable"),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,r()(B.a,{},void 0,r()(M.a,{md:4},void 0,r()(q.a,{legend:"First Variable:",defaultValue:this.state.firstVar||"",options:this.props.categorical,onChange:this.handleFirstVariableChange})),r()(M.a,{md:4},void 0,r()(q.a,{clearable:!0,legend:"Second Variable (optional):",defaultValue:this.state.secondVar||"",options:this.props.categorical,onChange:this.handleSecondVariableChange}))),r()(B.a,{style:{overflowX:"auto",width:"100%"}},void 0,this.renderTable()),r()(B.a,{},void 0,r()(Pe.a,{tooltip:"If the new values for all categories are numeric, you may tick this box to create a quantitative variable instead of a categorical one"},void 0,r()(ct.a,{legend:"Treat category labels as numbers (all new labels need to be digits)",defaultValue:!1,disabled:!this.state.onlyNumbers,onChange:function(){e.setState({castNumeric:!e.state.castNumeric})}}))),r()(B.a,{},void 0,r()(F.a,{style:{margin:8}},void 0,Nt,r()(S.a,{type:"text",placeholder:"Select name...",onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),Ct))))}}]),a}(y.Component);wt.defaultProps={logAction:function(){}};var xt=wt,kt=(a(1116),a(1032)),Vt=a.n(kt),St=a(1333),Ft=a.n(St);function Pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var Gt=x()("isle:data-explorer:group-transformer"),Bt=r()("p",{},void 0,"Proportions must add up to one."),Mt=r()(P.a,{},void 0,"Name of new variable:"),Ot=r()(G.a,{},void 0,"The new variable will be appended as a new column to the data table."),Ht=function(e){v()(a,e);var t=Pt(a);function a(e){var n;return i()(this,a),n=t.call(this,e),b()(d()(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),b()(d()(n),"handleGroupNumberChange",(function(e){for(var t=new Array(e).fill(1/e),a=new Array(e),r=0;r<a.length;r++)a[r]="Group ".concat(r+1);n.setState({groupProbs:t,labels:a,nGroups:e})})),b()(d()(n),"handleKeyPress",(function(e){if(13===e.charCode){for(var t=0,a=0;a<n.state.groupProbs.length;a++)t+=n.state.groupProbs[a];n.state.generatedName.length>2&&Ft()(t,1)<=15e-9&&n.makeNewVar()}})),b()(d()(n),"makeNewVar",(function(){Gt("Generating new categorical variable...");var e=W()(n.props.data),t=n.props.data[e[0]].length,a=Vt()(n.state.labels,{size:t,probs:n.state.groupProbs,replace:!0});n.props.onGenerate(n.state.generatedName,a),n.props.logAction(ee.m,{name:n.state.generatedName,labels:n.state.labels,groupProbs:n.state.groupProbs}),n.props.onHide()})),n.state={generatedName:"",nGroups:2,groupProbs:[.5,.5],labels:["Group 1","Group 2"]},n}return l()(a,[{key:"renderTable",value:function(){for(var e=this,t=new Array(this.state.nGroups),a=function(a){t[a]=r()(B.a,{},a,r()(M.a,{},void 0,r()(A.a,{legend:"Label for Group ".concat(a+1),defaultValue:e.state.labels[a],onChange:function(t){var n=e.state.labels.slice();n[a]=t,e.setState({labels:n})}})),r()(M.a,{},void 0,r()(T.b,{legend:"Group Proportion",onChange:function(t){var n=e.state.groupProbs.slice();n[a]=t,e.setState({groupProbs:n})},defaultValue:e.state.groupProbs[a],step:.01,min:0,max:1,numbersOnly:!1})))},n=0;n<t.length;n++)a(n);return r()(y.Fragment,{},void 0,t,Bt)}},{key:"render",value:function(){for(var e=0,t=0;t<this.state.groupProbs.length;t++)e+=this.state.groupProbs[t];var a=this.state.generatedName.length>2&&Ft()(e,1)<=15e-9;return r()(H.a,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,r()(R.a,{onHide:this.props.onHide,show:this.props.show,header:"Create group variables (e.g., for training/test set split or cross-validation)",footer:r()(C.a,{onClick:this.makeNewVar,disabled:!a},void 0,"Create new variable"),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,r()(B.a,{},void 0,r()(M.a,{},void 0,r()(T.b,{legend:"Number of groups",onChange:this.handleGroupNumberChange,defaultValue:this.state.nGroups,step:1,min:1,max:99}))),this.renderTable(),r()(B.a,{},void 0,r()(F.a,{style:{margin:8}},void 0,Mt,r()(S.a,{type:"text",placeholder:"Select name...",onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),Ot))))}}]),a}(y.Component);Ht.defaultProps={logAction:function(){}};var Rt=Ht;function qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h()(this,a)}}var At=function(e){v()(a,e);var t=qt(a);function a(e){var n;return i()(this,a),n=t.call(this,e),b()(d()(n),"renderFormulaModal",(function(){var e="formula"===n.state.active;return e&&n.props.data?r()(tt,{show:e,onHide:n.toggleFormulaModal,categorical:n.props.categorical,quantitative:n.props.quantitative,data:n.props.data,defaultCode:n.props.defaultCode,logAction:n.props.logAction,onGenerate:n.props.onGenerate,session:n.props.session}):null})),b()(d()(n),"renderBinModal",(function(){var e="bin"===n.state.active;return e&&n.props.data?r()(ye,{show:e,onHide:n.toggleBinModal,quantitative:n.props.quantitative,logAction:n.props.logAction,onGenerate:n.props.onGenerate,data:n.props.data}):null})),b()(d()(n),"renderCategoricalModal",(function(){var e="categorical"===n.state.active;return e&&n.props.data?r()(xt,{show:e,onHide:n.toggleCategoricalModal,categorical:n.props.categorical,logAction:n.props.logAction,onGenerate:n.props.onGenerate,data:n.props.data}):null})),b()(d()(n),"renderGroupModal",(function(){var e="group"===n.state.active;return e&&n.props.data?r()(Rt,{show:e,onHide:n.toggleGroupModal,logAction:n.props.logAction,onGenerate:n.props.onGenerate,data:n.props.data}):null})),b()(d()(n),"handleActive",(function(){n.props.onActive(n.state.active)})),b()(d()(n),"toggleFormulaModal",(function(){n.setState({active:"formula"===n.state.active?null:"formula"},n.handleActive)})),b()(d()(n),"toggleBinModal",(function(){n.setState({active:"bin"===n.state.active?null:"bin"},n.handleActive)})),b()(d()(n),"toggleCategoricalModal",(function(){n.setState({active:"categorical"===n.state.active?null:"categorical"},n.handleActive)})),b()(d()(n),"toggleGroupModal",(function(){n.setState({active:"group"===n.state.active?null:"group"},n.handleActive)})),n.state={active:null},n}return l()(a,[{key:"render",value:function(){return r()(y.Fragment,{},void 0,r()("div",{className:"well",style:{padding:15,margin:15}},void 0,r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleFormulaModal,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,"Interactions, Transformations (e.g., sqrt), Functions")),r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleBinModal,disabled:0===this.props.quantitative.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,"Bin quantitative variables into categorical")),r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleCategoricalModal,disabled:0===this.props.categorical.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,"Rename or combine categories")),r()("div",{style:{padding:12}},void 0,r()(C.a,{onClick:this.toggleGroupModal,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,"Create groups (e.g., for training-test set split or cross-validation)"))),this.renderBinModal(),this.renderFormulaModal(),this.renderCategoricalModal(),this.renderGroupModal())}}]),a}(y.Component);At.defaultProps={logAction:function(){},onActive:function(){},onGenerate:function(){},defaultCode:"",session:{}};t.default=At}}]);