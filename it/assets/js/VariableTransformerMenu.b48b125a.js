/*! For license information please see VariableTransformerMenu.b48b125a.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[3047],{598577:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ct}});var n,r,o,i,s=a(858255),l=a(574315),c=a(202784),d=(a(213980),a(770561)),u=(a(627476),a(95767),a(694882),a(298351),a(151119)),v=(a(850110),a(898837),a(911755)),p=a.n(v),Z=a(26266),f=a(830650),h=a(10863),g=a(96904),m=a(822736),b=a(260952),y=a(458264),w=a(312594),C=a(501258),N=a.n(C),x=a(437069),k=a.n(x),V=a(74039),P=a.n(V),F=a(224008),S=a.n(F),G=a(309765),H=a(741709),q=a(927447),L=a(551769),A=a(601822),O=a(292682),E=a(462874),R=a(997354),T=a(316305),B=a.n(T),z=a(927299),M=a(821337),K=a(148820),D=a(945157),j=a(5140),I=a(271768),W=a(921455),Y=a(938036),J=a(612249);function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var X=p()("isle:data-explorer:variable-transformer"),Q=/shapes\[(\d)\]\.x0/,_={group:null,displayDensity:!0,densityType:"Data-driven",chooseBins:!1,nBins:null};function ee(e,t){return e-t}var te=function(e){for(var t=[],a=0;a<e.length;a++)t.push({type:"line",x0:e[a],y0:-100,x1:e[a],y1:100,line:{color:"red",width:3}});return t},ae=function(e,t){var a=new Array(t.length);t[0]?a[0]=t[0]:a[0]="(-\u221e,".concat(e[0],")");for(var n=1;n<t.length;n++)t[n]?a[n]=t[n]:a[n]="[".concat(e[n-1],",").concat(e[n],")");var r=t.length-1;return t[r]?a[r]=t[r]:a[r]="[".concat(e[e.length-1],",\u221e)"),a},ne=function(e){var t,a,u=(0,c.useState)(""),v=(0,l.Z)(u,2),p=v[0],C=v[1],x=(0,c.useState)(0),V=(0,l.Z)(x,2),F=V[0],T=V[1],$=(0,c.useState)({variable:null,configHist:null,breakpoints:null,categories:null,customNames:null}),ne=(0,l.Z)($,2),re=ne[0],oe=ne[1],ie=p.length<2,se=function(){var t=re.variable,a=re.categories,n=re.breakpoints,r=e.data[t],o=(0,Y.Z)(r,a,n);e.logAction(j.dU,{name:p,variable:t,breaks:n,categories:a});var i=(0,z.Z)(p,a);e.onGenerate(i,o),e.onHide()},le=function(e){13!==e.charCode||ie||se()},ce=function(e){C(e.target.value)},de=function(e){return function(t){X("Change break point...");var a=re.breakpoints.slice();a[e]=P()(t,-F),a.sort(ee);var n=S()(re.configHist);n.layout.shapes=te(a),oe(U(U({},re),{},{configHist:n,breakpoints:a,categories:ae(a,re.customNames)}))}},ue=function(e){return function(t){var a=re.categories.slice();a[e]=t;var n=re.customNames.slice();n[e]=t;var r=U(U({},re),{},{categories:a,customNames:n});oe(r)}},ve=function(e){return function(){var t=re.breakpoints,a=re.categories,n=re.customNames;t.splice(e,1),a.splice(e,1),n.splice(e,1);var r=U({},re.configHist);r.layout.shapes=te(t),oe(U(U({},re),{},{configHist:r,categories:a,customNames:n,breakpoints:t}))}},pe=function(e){var t=k()(e),a=Q.exec(t[0]);if(a){var n=a[1],r=re.breakpoints.slice();r[n]=P()(e[t[0]],-F),r.sort(ee);var o=S()(re.configHist);o.layout.shapes=te(r),oe(U(U({},re),{},{configHist:o,breakpoints:r,categories:ae(r,re.customNames)}))}},Ze=function(t){X("Change variable to bin...");var a=U({data:e.data,variable:t},_),n=(0,I.N)(a);n.layout.yaxis={range:[(0,K.Z)(n.data[1].y),(0,D.Z)(n.data[1].y)],fixedrange:!0},n.layout.xaxis={fixedrange:!0};var r=e.data[t];r=r.filter((function(e){return(0,G.isPrimitive)(e)&&!B()(e)}));var o=[P()((0,M.Z)(r),-F)];n.layout.shapes=te(o);var i=[!1,!1];oe({variable:t,configHist:n,breakpoints:o,customNames:i,categories:ae(o,i)})},fe=function(){var t=re.breakpoints.slice(),a=e.data[re.variable];a=a.filter((function(e){return(0,G.isPrimitive)(e)&&!B()(e)}));var n=N()(.8,1.2)*(0,M.Z)(a);t.push(P()(n,-F)),t.sort(ee);var r=S()(re.configHist);r.layout.shapes=te(t);var o=re.customNames;o.push(!1);var i=U(U({},re),{},{breakpoints:t,configHist:r,categories:ae(t,o)});oe(i)};return(0,s.Z)(A.Z,{cancel:".card-body",onDragStart:W.Z,style:{zIndex:1006}},void 0,(0,s.Z)(E.Z,{onHide:e.onHide,show:e.show,header:e.t("bin-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:se,disabled:ie},void 0,e.t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,(t=re.configHist,a=(0,s.Z)(q.Z,{legend:e.t("variable-to-bin"),defaultValue:re.variable,options:e.quantitative,onChange:Ze,style:{maxWidth:400}}),t?(0,s.Z)(c.Fragment,{},void 0,a,(0,s.Z)(d.Z,{className:"insert-line-button",onClick:fe},void 0,e.t("insert-break-line")),(0,s.Z)("p",{},void 0,e.t("drag-red-bars"),"(",(0,s.Z)(H.Z,{legend:e.t("digits-after-comma-snap"),min:0,max:9,inline:!0,defaultValue:F,onChange:T}),")"),(0,s.Z)("div",{style:{height:250}},void 0,(0,s.Z)(O.Z,{data:t.data,layout:t.layout,editable:!0,fit:!0,removeButtons:!0,legendButtons:!1,onRelayout:pe})),(0,s.Z)("div",{},void 0,(0,s.Z)(b.Z,{className:"mb-2"},void 0,(0,s.Z)(b.Z.Header,{},void 0,e.t("choose-category-labels"),":"),(0,s.Z)(b.Z.Body,{},void 0,function(){var t=[],a=re.breakpoints,l=1===a.length;if(t.push((0,s.Z)(y.Z,{},"div-0",(0,s.Z)(w.Z,{md:7},void 0,n||(n=(0,s.Z)(R.Z,{raw:"x < "})),(0,s.Z)(H.Z,{inline:!0,onBlur:de(0),defaultValue:a[0],step:"any"})),(0,s.Z)(w.Z,{md:4},void 0,(0,s.Z)(L.Z,{legend:"".concat(e.t("label")," 1"),defaultValue:re.categories[0],onChange:ue(0),style:{width:200}},0)),r||(r=(0,s.Z)(w.Z,{md:1})))),a.length>1)for(var c=0;c<a.length-1;c++){var d=ue(c+1);t.push((0,s.Z)(y.Z,{},"div-".concat(c+1),(0,s.Z)(w.Z,{md:7},void 0,(0,s.Z)(H.Z,{inline:!0,onBlur:de(c),defaultValue:a[c],step:"any"}),o||(o=(0,s.Z)(R.Z,{raw:"\\le x <"})),(0,s.Z)(H.Z,{inline:!0,onBlur:de(c+1),defaultValue:a[c+1],step:"any"})),(0,s.Z)(w.Z,{md:4},void 0,(0,s.Z)(L.Z,{legend:"".concat(e.t("label")," ").concat(c+2),defaultValue:re.categories[c+1],onChange:d,style:{width:200}},1+c)),(0,s.Z)(w.Z,{md:1},void 0,(0,s.Z)(J.Z,{onClick:ve(c),style:{marginTop:"5px"},disabled:l,tooltipPlacement:"right"}))))}var u=a.length;return t.push((0,s.Z)(y.Z,{},"div-".concat(u),(0,s.Z)(w.Z,{md:7},void 0,i||(i=(0,s.Z)(R.Z,{raw:"x \\ge"})),(0,s.Z)(H.Z,{inline:!0,onChange:de(u-1),defaultValue:a[u-1],step:"any"})),(0,s.Z)(w.Z,{md:4},void 0,(0,s.Z)(L.Z,{legend:"Label ".concat(u+1),defaultValue:re.categories[u],onChange:ue(u),style:{width:200}},u)),(0,s.Z)(w.Z,{md:1},void 0,(0,s.Z)(J.Z,{onClick:ve(u-1),style:{marginTop:"5px"},disabled:l})))),t}()))),(0,s.Z)(h.Z,{style:{width:"fit-content"}},void 0,(0,s.Z)(f.Z,{},void 0,e.t("name-new-variable"),":"),(0,s.Z)(Z.Z,{type:"text",placeholder:e.t("select-name"),onChange:ce,onKeyPress:le}),(0,s.Z)(g.Z,{},void 0,e.t("new-variable-appended")))):(0,s.Z)(c.Fragment,{},void 0,a,(0,s.Z)(m.Z,{variant:"info"},void 0,e.t("select-variable-bin"))))))};ne.defaultProps={logAction:function(){},onGenerate:function(){}};var re,oe,ie,se=ne,le=(a(382139),a(264659)),ce=a(904730),de=a(673989),ue=a(175663),ve=a(750591),pe=a(575630),Ze=(a(217732),a(6059),a(319371),a(387612)),fe=a(845450),he=a(423184),ge=a(482228),me=a(738314),be=a(661599),ye=a(304964),we=a(150275),Ce=a(605977),Ne=a.n(Ce),xe=a(287013),ke=a.n(xe),Ve=a(302467),Pe=a.n(Ve),Fe=a(693171),Se=a(123950);function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,pe.Z)(e);if(t){var r=(0,pe.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,ve.Z)(this,a)}}var He=Ne()(0,10,1),qe=/(?:^|\n)([^\n]*)$/,Le=/^[0-9]/,Ae=c.forwardRef((function(e,t){var a=e.children,n=e.style,r=e.className,o=e["aria-labelledby"],i=(0,c.useState)(""),d=(0,l.Z)(i,2),u=d[0],v=d[1];return c.createElement("div",{ref:t,style:n,className:r,"aria-labelledby":o},(0,s.Z)(Z.Z,{className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return v(e.target.value)},value:u}),(0,s.Z)("ul",{className:"list-unstyled"},void 0,c.Children.toArray(a).filter((function(e){return!u||e.props.children.toLowerCase().startsWith(u)}))))})),Oe=function(e){(0,ue.Z)(a,e);var t=Ge(a);function a(e){var n;return(0,le.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,de.Z)(n),"handleGenerate",(function(){var e,t=n.state,a=t.code,r=t.name;ke()(a,"return ")||(a=Pe()(a,qe,"\nreturn $1"));try{e=(0,Fe.Z)(a,n.props.data),n.props.logAction(j.gx,{code:a,name:r}),n.props.onGenerate(r,e)}catch(o){return n.props.session.addNotification({title:"Errored",message:"Encountered the following error: "+o.message,level:"error",position:"tr"})}n.props.onHide()})),(0,u.Z)((0,de.Z)(n),"handleNameChange",(function(e){n.setState({name:e.target.value})})),(0,u.Z)((0,de.Z)(n),"handleCodeChange",(function(e){n.setState({code:e})})),(0,u.Z)((0,de.Z)(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.name.length>=2&&n.handleGenerate()})),(0,u.Z)((0,de.Z)(n),"insertVarFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a="datum";t+=a+=!ke()(e," ")&&!ke()(e,".")&&!Le.test(e)?".".concat(e):"['".concat(e,"']"),t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),(0,u.Z)((0,de.Z)(n),"insertLiteralFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=e;t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length})}})),(0,u.Z)((0,de.Z)(n),"insertFuncFactory",(function(e){return function(){var t=n.state.code.substring(0,n.state.selection),a=" "+e+"()";t+=a,t+=n.state.code.substring(n.state.selection),n.setState({code:t,selection:n.state.selection+a.length-1})}})),n.state={code:e.defaultCode,selection:null,name:"",showGuide:!1},n}return(0,ce.Z)(a,[{key:"render",value:function(){var e=this,t=this.props.t,a=this.props.quantitative.map((function(t,a){return(0,s.Z)(me.Z.Item,{onClick:e.insertVarFactory(t),eventKey:a},a,t)}));return(0,s.Z)(A.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,(0,s.Z)(E.Z,{show:this.props.show,onHide:this.props.onHide,header:this.props.t("formula-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:this.handleGenerate,disabled:this.state.name.length<2},void 0,this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,(0,s.Z)("div",{className:"formula-transformer-body"},void 0,(0,s.Z)(be.Z,{headerClassName:"title",header:this.state.showGuide?t("hide-example-guide"):t("show-example-guide"),visible:this.state.showGuide,onClick:function(){return e.setState({showGuide:!e.state.showGuide})}},void 0,(0,s.Z)("p",{},void 0,t("formula-transformer-example-intro")),(0,s.Z)(fe.Z,{condensed:!0},void 0,(0,s.Z)("thead",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("th",{},void 0,t("type")),(0,s.Z)("th",{},void 0,t("example")),(0,s.Z)("th",{},void 0,t("description")))),(0,s.Z)("tbody",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("td",{},void 0,t("interaction"),":"),(0,s.Z)("td",{},void 0,(0,s.Z)("code",{},void 0,"datum.",this.props.quantitative[0]," * datum.",this.props.quantitative[1])),(0,s.Z)("td",{},void 0,(0,s.Z)(Ze.c,{i18nKey:"example-description-multiply",ns:"DataExplorer"},void 0,"Multiply values of variables ",(0,s.Z)("code",{},void 0,{first:this.props.quantitative[0]})," and ",(0,s.Z)("code",{},void 0,{second:this.props.quantitative[1]})))),(0,s.Z)("tr",{},void 0,(0,s.Z)("td",{},void 0,t("transformation"),":"),(0,s.Z)("td",{},void 0,(0,s.Z)("code",{},void 0,"exp( datum.",this.props.quantitative[0]," )")),(0,s.Z)("td",{},void 0,(0,s.Z)(Ze.c,{i18nKey:"example-description-exponential",ns:"DataExplorer"},void 0,"Natural exponential function of variable ",(0,s.Z)("code",{},void 0,{variable:this.props.quantitative[0]})))),(0,s.Z)("tr",{},void 0,(0,s.Z)("td",{},void 0,t("function"),":"),(0,s.Z)("td",{},void 0,(0,s.Z)("code",{},void 0,"9/5 * ",this.props.quantitative[0]," + 32")),(0,s.Z)("td",{},void 0,(0,s.Z)(Ze.c,{i18nKey:"example-description-calculation",ns:"DataExplorer"},void 0,"Multiply values of ",(0,s.Z)("code",{},void 0,{variable:this.props.quantitative[0]})," by ",re||(re=(0,s.Z)("code",{},void 0,"9/5"))," and add ",oe||(oe=(0,s.Z)("code",{},void 0,"32")))))))),ie||(ie=(0,s.Z)("hr",{})),(0,s.Z)("div",{className:"mb-2"},void 0,(0,s.Z)(ge.Z,{style:{marginBottom:5}},void 0,(0,s.Z)(me.Z,{className:"mr-2"},void 0,(0,s.Z)(me.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,t("quantitative")),(0,s.Z)(me.Z.Menu,{variant:"light",as:Ae,id:"bg-nested-dropdown"},void 0,a)),(0,s.Z)(me.Z,{className:"mr-2"},void 0,(0,s.Z)(me.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},void 0,t("categorical")),(0,s.Z)(me.Z.Menu,{variant:"light",as:Ae,id:"bg-nested-dropdown"},void 0,this.props.categorical.map((function(t,a){return(0,s.Z)(me.Z.Item,{onClick:e.insertVarFactory(t),eventKey:a},a,t)})))))),(0,s.Z)(b.Z,{className:"mb-2"},void 0,(0,s.Z)(b.Z.Body,{},void 0,(0,s.Z)(ge.Z,{style:{marginBottom:5}},void 0,(0,s.Z)(he.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" < ")},void 0,"<"),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" > ")},void 0,">"),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" <= ")},void 0,"<="),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" >= ")},void 0,">=")),(0,s.Z)(he.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(we.Z,{placement:"top",tooltip:t("open-parenthesis")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" ( ")},void 0,"(")),(0,s.Z)(we.Z,{placement:"top",tooltip:t("closing-parenthesis")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" ) ")},void 0,")"))),(0,s.Z)(he.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(we.Z,{placement:"top",tooltip:t("addition")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" + ")},void 0,"+")),(0,s.Z)(we.Z,{placement:"top",tooltip:t("subtraction")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" - ")},void 0,"-")),(0,s.Z)(we.Z,{placement:"top",tooltip:t("multiplication")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" * ")},void 0,"*")),(0,s.Z)(we.Z,{placement:"top",tooltip:t("division")},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" / ")},void 0,"/"))),(0,s.Z)(he.Z,{size:"sm",className:"mr-2"},void 0,(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" && ")},void 0,t("and")),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" || ")},void 0,t("or")),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(" !")},void 0,t("not"))),(0,s.Z)(he.Z,{size:"sm",className:"me-2"},void 0,Se.map((function(t,a){return(0,s.Z)(d.Z,{variant:"light",onClick:e.insertFuncFactory(t),eventKey:a},a,t)})))),(0,s.Z)(ge.Z,{},void 0,(0,s.Z)(he.Z,{size:"sm",className:"mr-2"},void 0,He.map((function(t,a){return(0,s.Z)(d.Z,{variant:"light",onClick:e.insertLiteralFactory("".concat(t))},a,t)})),(0,s.Z)(d.Z,{variant:"light",onClick:this.insertLiteralFactory(".")},void 0,"."))))),(0,s.Z)(b.Z,{className:"mb-2"},void 0,(0,s.Z)(b.Z.Body,{},void 0,c.createElement(ye.Z,{ref:function(t){e.textarea=t},legend:"".concat(t("expression"),":"),placeholder:t("enter-formula"),value:this.state.code,onChange:this.handleCodeChange,onBlur:function(t){var a=t.target.selectionStart;e.setState({selection:a})},rows:3}))),(0,s.Z)(h.Z,{style:{margin:8}},void 0,(0,s.Z)(f.Z,{},void 0,t("name-new-variable"),":"),(0,s.Z)(Z.Z,{type:"text",placeholder:t("select-name"),onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),(0,s.Z)(g.Z,{},void 0,t("new-variable-appended"))))))}}]),a}(c.Component);Oe.defaultProps={logAction:function(){},onGenerate:function(){},defaultCode:"",session:{}};var Ee,Re=Oe,Te=a(122081),Be=a(147777),ze=a.n(Be),Me=a(471205),Ke=a.n(Me),De=a(888244),je=a.n(De),Ie=a(785745),We=a(833562),Ye=a(280093);function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,pe.Z)(e);if(t){var r=(0,pe.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,ve.Z)(this,a)}}var $e=p()("isle:data-explorer:variable-transformer");function Ue(e){return e?Pe()(e,".","[dot]"):e}function Xe(e){for(var t=k()(e),a=!0,n=0;n<t.length;n++)je()(e[t[n]])||(a=!1);return a}var Qe=function(e){(0,ue.Z)(a,e);var t=Je(a);function a(e){var n;(0,le.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,de.Z)(n),"handleFirstVariableChange",(function(e){var t,a={};if(n.state.secondVar){var r=e,o=n.state.secondVar,i=n.props.data[r];t=ze()(i,Ke());for(var s=(0,Ye.Z)(t,r),l=(0,Ye.Z)(n.state.secondFreqs,o),c=0;c<s.length;c++)for(var d=0;d<l.length;d++){var u=s[c]+"-"+l[d];a[Ue(u)]=u}}else{var v=n.props.data[e];t=ze()(v,Ke());for(var p=(0,Ye.Z)(t,e),Z=0;Z<p.length;Z++)a[Ue(p[Z])]=p[Z]}var f=Xe(a);n.setState({firstVar:e,firstFreqs:t,nameMappings:a,onlyNumbers:f})})),(0,u.Z)((0,de.Z)(n),"handleSecondVariableChange",(function(e){if(!e){for(var t=n.state.firstVar,a=(0,Ye.Z)(n.state.firstFreqs,t),r={},o=0;o<a.length;o++)r[Ue(a[o])]=a[o];return n.setState({secondVar:e,nameMappings:r})}for(var i={},s=n.state.firstVar,l=n.props.data[e],c=ze()(l,Ke()),d=(0,Ye.Z)(n.state.firstFreqs,s),u=(0,Ye.Z)(c,e),v=0;v<d.length;v++)for(var p=0;p<u.length;p++){var Z=d[v]+"-"+u[p];i[Ue(Z)]=Z}var f=Xe(i);n.setState({secondVar:e,secondFreqs:c,nameMappings:i,onlyNumbers:f})})),(0,u.Z)((0,de.Z)(n),"handleKeyPress",(function(e){13===e.charCode&&n.state.generatedName.length>=2&&n.makeNewVar()})),(0,u.Z)((0,de.Z)(n),"changeFreqFactory",(function(e){return function(t){var a=S()(n.state.nameMappings);a[Ue(e)]=t.target.value;var r=Xe(a);n.setState({nameMappings:a,onlyNumbers:r})}})),(0,u.Z)((0,de.Z)(n),"changeContigencyFactory",(function(e,t){return function(a){var r=S()(n.state.nameMappings);r[Ue(t)+"-"+Ue(e)]=a.target.value,n.setState({nameMappings:r})}})),(0,u.Z)((0,de.Z)(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),(0,u.Z)((0,de.Z)(n),"makeNewVar",(function(){$e("Generating new categorical variable...");var e=n.state,t=e.firstVar,a=e.secondVar,r=e.nameMappings,o=e.castNumeric,i=(0,We.Z)(t,a,r,n.props.data,o);n.props.onGenerate(n.state.generatedName,i),n.props.logAction(j.CS,{name:n.state.generatedName,firstVar:t,secondVar:a,nameMappings:r,castNumeric:o}),n.props.onHide()})),(0,u.Z)((0,de.Z)(n),"renderFrequencyTable",(function(){var e=n.state.firstVar,t=n.props.data[e],a=ze()(t,Ke()),r=(0,Ye.Z)(a,e);return(0,s.Z)(Te.Z,{bordered:!0,style:{margin:8}},void 0,(0,s.Z)("thead",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("th",{},void 0,n.props.t("old"),":"),r.map((function(t,a){return(0,s.Z)("th",{},"".concat(e,"-").concat(a,"-old"),t)})))),(0,s.Z)("tbody",{},void 0,(0,s.Z)("tr",{},void 0,(0,s.Z)("th",{},void 0,n.props.t("new"),":"),r.map((function(t,a){return(0,s.Z)("th",{},"".concat(e,"-").concat(a,"-new"),(0,s.Z)("input",{className:"transformer-table-input",type:"text",defaultValue:t,onChange:n.changeFreqFactory(t)}))}))),(0,s.Z)("tr",{style:{borderTop:"1px solid black"}},void 0,(0,s.Z)("th",{},void 0,n.props.t("frequencies"),":"),r.map((function(t,a){var r=n.state.firstFreqs[t];return(0,s.Z)("td",{},"".concat(e,"-").concat(a,"-freq"),r)})))))})),(0,u.Z)((0,de.Z)(n),"renderContingencyTable",(function(){var e=n.state.secondVar,t=n.state.firstVar,a=n.props.data[e],r=n.props.data[t],o=ze()(a,Ke()),i=ze()(r,Ke()),l=(0,Ye.Z)(o,e),c=(0,Ye.Z)(i,t);return(0,s.Z)(Te.Z,{bordered:!0,style:{margin:8}},void 0,(0,s.Z)("tr",{},void 0,Ee||(Ee=(0,s.Z)("th",{})),c.map((function(e,t){return(0,s.Z)("th",{},"".concat(e,"-").concat(t),e)}))),l.map((function(e,t){return(0,s.Z)("tr",{},"".concat(e,"-").concat(t),(0,s.Z)("th",{},void 0,e),c.map((function(t,a){return(0,s.Z)("td",{},"".concat(e,"-").concat(t,"-").concat(a),(0,s.Z)("input",{className:"transformer-table-input",type:"text",defaultValue:"".concat(t,"-").concat(e),onChange:n.changeContigencyFactory(e,t)}))})))})))}));for(var r=e.categorical[0],o=e.data[r],i=ze()(o,Ke()),l=(0,Ye.Z)(i,r),c={},d=0;d<l.length;d++)c[Ue(l[d])]=l[d];return n.state={generatedName:"",firstVar:r,firstFreqs:i,nameMappings:c,secondVar:null,secondFreqs:null,castNumeric:!1,onlyNumbers:!1},n}return(0,ce.Z)(a,[{key:"renderTable",value:function(){return this.state.firstVar&&this.state.secondVar?this.renderContingencyTable():this.state.firstVar||this.state.secondVar?this.renderFrequencyTable():null}},{key:"render",value:function(){var e=this,t=this.props.t;return(0,s.Z)(A.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,(0,s.Z)(E.Z,{onHide:this.props.onHide,show:this.props.show,header:t("categorical-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:this.makeNewVar,disabled:this.state.generatedName.length<2},void 0,t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},void 0,(0,s.Z)(y.Z,{},void 0,(0,s.Z)(w.Z,{md:4},void 0,(0,s.Z)(q.Z,{legend:t("first-variable"),defaultValue:this.state.firstVar||"",options:this.props.categorical,onChange:this.handleFirstVariableChange})),(0,s.Z)(w.Z,{md:4},void 0,(0,s.Z)(q.Z,{clearable:!0,legend:t("optional-second-variable"),defaultValue:this.state.secondVar||"",options:this.props.categorical,onChange:this.handleSecondVariableChange}))),(0,s.Z)(y.Z,{style:{overflowX:"auto",width:"100%"}},void 0,this.renderTable()),(0,s.Z)(y.Z,{},void 0,(0,s.Z)(we.Z,{tooltip:t("treat-labels-as-numbers-tooltip")},void 0,(0,s.Z)(Ie.Z,{legend:t("treat-labels-as-numbers"),defaultValue:!1,disabled:!this.state.onlyNumbers,onChange:function(){e.setState({castNumeric:!e.state.castNumeric})}}))),(0,s.Z)(y.Z,{},void 0,(0,s.Z)(h.Z,{style:{margin:8}},void 0,(0,s.Z)(f.Z,{},void 0,t("name-new-variable"),":"),(0,s.Z)(Z.Z,{type:"text",placeholder:t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),(0,s.Z)(g.Z,{},void 0,t("new-variable-appended"))))))}}]),a}(c.Component);Qe.defaultProps={logAction:function(){}};var _e=Qe,et=(a(448977),a(240054)),tt=a.n(et),at=a(1570),nt=a.n(at);function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,pe.Z)(e);if(t){var r=(0,pe.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,ve.Z)(this,a)}}var ot=p()("isle:data-explorer:group-transformer"),it=function(e){(0,ue.Z)(a,e);var t=rt(a);function a(e){var n;return(0,le.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,de.Z)(n),"handleGeneratedNameChange",(function(e){n.setState({generatedName:e.target.value})})),(0,u.Z)((0,de.Z)(n),"handleGroupNumberChange",(function(e){for(var t=new Array(e).fill(1/e),a=new Array(e),r=0;r<a.length;r++)a[r]="".concat(n.props.t("group")," ").concat(r+1);n.setState({groupProbs:t,labels:a,nGroups:e})})),(0,u.Z)((0,de.Z)(n),"handleKeyPress",(function(e){if(13===e.charCode){for(var t=0,a=0;a<n.state.groupProbs.length;a++)t+=n.state.groupProbs[a];n.state.generatedName.length>2&&nt()(t,1)<=15e-9&&n.makeNewVar()}})),(0,u.Z)((0,de.Z)(n),"makeNewVar",(function(){ot("Generating new categorical variable...");var e=k()(n.props.data),t=n.props.data[e[0]].length,a=tt()(n.state.labels,{size:t,probs:n.state.groupProbs,replace:!0});n.props.onGenerate(n.state.generatedName,a),n.props.logAction(j.Dp,{name:n.state.generatedName,labels:n.state.labels,groupProbs:n.state.groupProbs}),n.props.onHide()})),n.state={generatedName:"",nGroups:2,groupProbs:[.5,.5],labels:["Group 1","Group 2"]},n}return(0,ce.Z)(a,[{key:"renderTable",value:function(){for(var e=this,t=new Array(this.state.nGroups),a=function(a){t[a]=(0,s.Z)(y.Z,{},a,(0,s.Z)(w.Z,{},void 0,(0,s.Z)(L.Z,{legend:"Label for Group ".concat(a+1),defaultValue:e.state.labels[a],onChange:function(t){var n=e.state.labels.slice();n[a]=t,e.setState({labels:n})}})),(0,s.Z)(w.Z,{},void 0,(0,s.Z)(H.Z,{legend:e.props.t("group-proportion"),onChange:function(t){var n=e.state.groupProbs.slice();n[a]=t,e.setState({groupProbs:n})},defaultValue:e.state.groupProbs[a],step:.01,min:0,max:1,numbersOnly:!1})))},n=0;n<t.length;n++)a(n);return(0,s.Z)(c.Fragment,{},void 0,t,(0,s.Z)("p",{},void 0,this.props.t("proportions-sum-one")))}},{key:"render",value:function(){for(var e=0,t=0;t<this.state.groupProbs.length;t++)e+=this.state.groupProbs[t];var a=this.state.generatedName.length>2&&nt()(e,1)<=15e-9;return(0,s.Z)(A.Z,{cancel:".card-body",onDragStart:function(e){e.stopPropagation()},style:{zIndex:1006}},void 0,(0,s.Z)(E.Z,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("group-transformer-header"),footer:(0,s.Z)(d.Z,{onClick:this.makeNewVar,disabled:!a},void 0,this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},void 0,(0,s.Z)(y.Z,{},void 0,(0,s.Z)(w.Z,{},void 0,(0,s.Z)(H.Z,{legend:this.props.t("number-of-groups"),onChange:this.handleGroupNumberChange,defaultValue:this.state.nGroups,step:1,min:1,max:99}))),this.renderTable(),(0,s.Z)(y.Z,{},void 0,(0,s.Z)(h.Z,{style:{margin:8}},void 0,(0,s.Z)(f.Z,{},void 0,this.props.t("name-new-variable"),":"),(0,s.Z)(Z.Z,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),(0,s.Z)(g.Z,{},void 0,this.props.t("new-variable-appended"))))))}}]),a}(c.Component);it.defaultProps={logAction:function(){}};var st=it,lt=function(e){var t,a=e.data,n=e.categorical,r=e.quantitative,o=e.t,i=e.session,u=e.defaultCode,v=e.logAction,p=e.onGenerate,Z=(0,c.useState)(null),f=(0,l.Z)(Z,2),h=f[0],g=f[1],m=function(){var t="formula"===h?null:"formula";g(t),e.onActive(t)},b=function(){var t="bin"===h?null:"bin";g(t),e.onActive(t)},y=function(){var t="categorical"===h?null:"categorical";g(t),e.onActive(t)},w=function(){var t="group"===h?null:"group";g(t),e.onActive(t)};if(a)switch(h){case"bin":t=(0,s.Z)(se,{show:!0,onHide:b,quantitative:r,logAction:v,onGenerate:p,data:a,t:o});break;case"categorical":t=(0,s.Z)(_e,{show:!0,onHide:y,categorical:n,logAction:v,onGenerate:p,data:a,t:o});break;case"formula":t=(0,s.Z)(Re,{show:!0,onHide:m,categorical:n,quantitative:r,data:a,defaultCode:u,logAction:v,onGenerate:p,session:i,t:o});break;case"group":t=(0,s.Z)(st,{show:!0,onHide:w,logAction:v,onGenerate:p,data:a,t:o})}return(0,s.Z)(c.Fragment,{},void 0,(0,s.Z)("div",{className:"well",style:{padding:15,margin:15}},void 0,(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:m,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,o("interactions-functions"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:b,disabled:!r||0===r.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,o("bin-quantitative"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:y,disabled:!n||0===n.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,o("rename-or-combine"))),(0,s.Z)("div",{style:{padding:12}},void 0,(0,s.Z)(d.Z,{onClick:w,variant:"primary",block:!0,style:{fontSize:"1.2em"}},void 0,o("create-groups")))),t)};lt.defaultProps={logAction:function(){},onActive:function(){},onGenerate:function(){},defaultCode:"",session:{}};var ct=lt},921455:function(e,t){"use strict";t.Z=function(e){e.stopPropagation()}},217732:function(e,t,a){"use strict";var n=a(542985),r=a(410875),o=a(542094),i="startsWith",s="".startsWith;n(n.P+n.F*a(708852)(i),"String",{startsWith:function(e){var t=o(this,e,i),a=r(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return s?s.call(t,n,a):t.slice(a,a+n.length)===n}})},888244:function(e,t,a){"use strict";var n=a(667237);e.exports=n},667237:function(e,t,a){"use strict";var n=a(294565).isPrimitive;e.exports=function(e){var t,a,r;if(!n(e))return!1;if(0===(t=e.length))return!1;for(r=0;r<t;r++)if((a=e.charCodeAt(r))<48||a>57)return!1;return!0}},915521:function(e,t,a){"use strict";var n=a(501874),r=a(567359),o=a(268949),i=a(833022),s=a(213939),l=a(700601),c=a(362739),d=a(306830),u=a(149074).factory,v=a(422957),p=a(488088),Z=a(15311),f=a(583764);e.exports=function(){var e,t,a,h,g,m;if(0===arguments.length)t=u();else if(1===arguments.length){if(!i(e=arguments[0]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(l(e,"prng")){if(!s(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else{if(h=Z(g=arguments[0],m=arguments[1]))throw h;if(arguments.length>2){if(!i(e=arguments[2]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(l(e,"prng")){if(!s(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else t=u()}return n(a=void 0===g?P:V,"NAME","uniform"),e&&e.prng?(n(a,"seed",null),n(a,"seedLength",null),o(a,"state",c(null),d),n(a,"stateLength",null),n(a,"byteLength",null),n(a,"toJSON",c(null)),n(a,"PRNG",t)):(r(a,"seed",b),r(a,"seedLength",y),o(a,"state",N,x),r(a,"stateLength",w),r(a,"byteLength",C),n(a,"toJSON",k),n(a,"PRNG",t),t=t.normalized),a;function b(){return t.seed}function y(){return t.seedLength}function w(){return t.stateLength}function C(){return t.byteLength}function N(){return t.state}function x(e){t.state=e}function k(){var e={type:"PRNG"};return e.name=a.NAME,e.state=p(t.state),e.params=void 0===g?[]:[g,m],e}function V(){return f(t,g,m)}function P(e,a){return v(e)||v(a)||e>=a?NaN:f(t,e,a)}}},501258:function(e,t,a){"use strict";var n=a(501874),r=a(387944);n(r,"factory",a(915521)),e.exports=r},387944:function(e,t,a){"use strict";var n=a(915521)();e.exports=n},583764:function(e){"use strict";e.exports=function(e,t,a){var n=e();return a*n+(1-n)*t}},15311:function(e,t,a){"use strict";var n=a(309765).isPrimitive,r=a(316305);e.exports=function(e,t){return!n(e)||r(e)?new TypeError("invalid argument. First argument must be a number primitive and not `NaN`. Value: `"+e+"`."):!n(t)||r(t)?new TypeError("invalid argument. Second argument must be a number primitive and not `NaN`. Value: `"+t+"`."):e>=t?new RangeError("invalid argument. Minimum support `a` must be less than maximum support `b`. Value: `["+e+","+t+"]`."):null}},482228:function(e,t,a){"use strict";var n=a(607560),r=a(998283),o=a(72779),i=a.n(o),s=a(202784),l=a(429658),c=["bsPrefix","className"],d=s.forwardRef((function(e,t){var a=e.bsPrefix,o=e.className,d=(0,r.Z)(e,c),u=(0,l.vE)(a,"btn-toolbar");return s.createElement("div",(0,n.Z)({},d,{ref:t,className:i()(o,u)}))}));d.displayName="ButtonToolbar",d.defaultProps={role:"toolbar"},t.Z=d},845450:function(e,t,a){"use strict";var n=a(607560),r=a(998283),o=a(72779),i=a.n(o),s=a(202784),l=a(429658),c=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],d=s.forwardRef((function(e,t){var a=e.bsPrefix,o=e.className,d=e.striped,u=e.bordered,v=e.borderless,p=e.hover,Z=e.size,f=e.variant,h=e.responsive,g=(0,r.Z)(e,c),m=(0,l.vE)(a,"table"),b=i()(o,m,f&&m+"-"+f,Z&&m+"-"+Z,d&&m+"-striped",u&&m+"-bordered",v&&m+"-borderless",p&&m+"-hover"),y=s.createElement("table",(0,n.Z)({},g,{className:b,ref:t}));if(h){var w=m+"-responsive";return"string"==typeof h&&(w=w+"-"+h),s.createElement("div",{className:w},y)}return y}));t.Z=d}}]);