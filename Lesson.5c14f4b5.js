(window.webpackJsonp=window.webpackJsonp||[]).push([[211],{5565:function(e,t,n){"use strict";var o=n(363),i=n(390);Object(i.b)("LanguageSwitcher");var a=Object(o.a)((function(){return Promise.all([n.e(0),n.e(5),n.e(6),n.e(363),n.e(174)]).then(n.bind(null,6307))}));t.a=a},5566:function(e,t,n){"use strict";n(377);var o=n(365),i=n.n(o),a=(n(376),n(368),n(370)),s=n.n(a),c=n(371),r=n.n(c),l=n(387),u=n.n(l),d=n(374),p=n.n(d),f=n(375),h=n.n(f),v=n(373),g=n.n(v),m=n(366),b=n.n(m),x=n(0),y=(n(357),n(416)),C=n.n(y),S=n(1824),w=n(623),R=n.n(w),N=n(1531),k=n.n(N);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return h()(this,n)}}var I=C()("isle:lesson:contextmenu"),O=["input","textarea"];var L=function(e){p()(n,e);var t=T(n);function n(e){var o;return s()(this,n),o=t.call(this,e),b()(u()(o),"handleSelectionChange",(function(e){if(!o.state.contextMenuIsOpen){var t,n=window.getSelection(),i=(t=document.activeElement)&&~O.indexOf(t.tagName.toLowerCase())?!t.readOnly&&!t.disabled:(t=getSelection().anchorNode)?(t=t.parentNode).isContentEditable:void 0,a=document.activeElement;if(-1!==O.indexOf(a.tagName.toLowerCase())){var s=a.value.slice(a.selectionStart,a.selectionEnd);return o.setState({lastText:s,lastActive:a,editable:i})}if(n.isCollapsed&&"Range"!==n.type)setTimeout((function(){o.forceUpdate()}),150);else if(o.lastSelection=n,n.getRangeAt&&n.rangeCount){var c=n.getRangeAt(0),r=n.toString();o.setState({lastActive:a,lastRange:c,lastText:r,editable:i})}}})),b()(u()(o),"highlightText",(function(e){I("Highlight the selected text..."),document.designMode="on";var t=window.getSelection();t.removeAllRanges(),t.addRange(o.state.lastRange),document.execCommand("styleWithCSS",!1,!0),document.execCommand("backColor",!1,"yellow"),document.designMode="off"})),b()(u()(o),"removeHighlight",(function(e){I("Highlight the selected text...");var t=window.getSelection();t.removeAllRanges(),t.addRange(o.state.lastRange),document.designMode="on",document.execCommand("styleWithCSS",!1,!0),document.execCommand("backColor",!1,"inherit"),document.designMode="off"})),b()(u()(o),"cutSelection",(function(){var e=o.state.lastActive;if(-1!==O.indexOf(e.tagName.toLowerCase()))return e.value=R()(e.value,o.state.lastText,""),navigator.clipboard.writeText(o.state.lastText);var t=window.getSelection();t.removeAllRanges(),t.addRange(o.state.lastRange),document.execCommand("cut")})),b()(u()(o),"copyToClipboard",(function(e){I("Copying selection to clipboard... "),navigator.clipboard.writeText(o.state.lastText)})),b()(u()(o),"copyFromClipboard",(function(){navigator.clipboard.readText().then((function(e){if(!e)return o.props.session.addNotification({title:o.props.t("clipboard-empty"),message:o.props.t("clipboard-empty-message"),level:"error",position:"tr"});var t=o.state.lastActive;t&&t.focus(),document.execCommand("insertText",!1,e)}))})),b()(u()(o),"textToSpeech",(function(){var e=o.state.lastText;I("Read aloud: "+e);var t=o.props.session;if(k()(window.speechSynthesis.getVoices()))return t.addNotification({title:o.props.t("voice-not-supported"),message:o.props.t("voice-not-supported-message"),level:"error",position:"tr"});var n=new SpeechSynthesisUtterance(e);n.lang=t.config.language||"en-US",window.speechSynthesis.speak(n)})),o.state={lastRange:null,lastText:"",contextMenuIsOpen:!1,editable:!1},o}return r()(n,[{key:"componentDidMount",value:function(){document.addEventListener("selectionchange",this.handleSelectionChange)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("selectionchange",this.handleSelectionChange)}},{key:"render",value:function(){var e=this,t=[],n=window.getSelection(),o=document.activeElement,a=o&&-1!==O.indexOf(o.tagName.toLowerCase());if((!n.isCollapsed||"Range"===n.type)&&(this.state.editable&&t.push(i()(S.c,{onClick:this.cutSelection},0,this.props.t("cut"))),t.push(i()(S.c,{onClick:this.copyToClipboard},1,this.props.t("copy"))),t.push(i()(S.c,{onClick:this.textToSpeech},2,this.props.t("read-aloud"))),!a&&!o.isContentEditable&&(t.push(i()(S.c,{onClick:this.highlightText},3,this.props.t("highlight"))),n&&n.focusNode))){var s=n.focusNode.parentElement;s&&s.style&&"yellow"===s.style.backgroundColor&&t.push(i()(S.c,{onClick:this.removeHighlight},4,this.props.t("remove-highlight")))}return a?t.push(i()(S.c,{onClick:this.copyFromClipboard},5,this.props.t("paste"))):o.isContentEditable||t.push(i()(S.c,{onClick:function(t){e.props.addNote({left:t.pageX,top:t.pageY})}},6,this.props.t("add-note"))),i()(S.a,{id:"lessonWindow",onShow:function(){I("Context menu has been opened..."),e.setState({contextMenuIsOpen:!0})},onHide:function(){I("Context menu has been closed..."),e.setState({contextMenuIsOpen:!1})}},void 0,t)}}]),n}(x.Component);t.a=L},5567:function(e,t,n){"use strict";var o=n(365),i=n.n(o);n(0),n(281);t.a=function(e){return i()("div",{className:"forbidden-wrapper"},void 0,i()("h3",{className:"forbidden-header"},void 0,e.t("not-available-yet")))}},5568:function(e,t,n){"use strict";(function(e){var t=n(1105),o=n(605),i=n(2376),a=n(390);t.a.use(i.a).use(o.e).init({debug:!!e.env.DEBUG_I18N,lng:localStorage.getItem("i18nextLng")||"en",fallbackLng:"en",ns:["components"],defaultNS:"components",resources:a.a,react:{bindI18n:"languageChanged",bindI18nStore:"added",wait:!1},interpolation:{escapeValue:!1}});t.a}).call(this,n(526))},6418:function(e,t,n){"use strict";n.r(t),function(e){n(376),n(368),n(377);var o=n(365),i=n.n(o),a=n(370),s=n.n(a),c=n(371),r=n.n(c),l=n(387),u=n.n(l),d=n(374),p=n.n(d),f=n(375),h=n.n(f),v=n(373),g=n.n(v),m=n(366),b=n.n(m),x=n(0),y=n.n(x),C=(n(357),n(5560)),S=n.n(C),w=n(1824),R=n(631),N=n(3292),k=n.n(N),T=n(5565),I=n(1858),O=n(899),L=n(440),D=n(444),E=n(619),A=n(5566),M=n(5567);n(5568);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return h()(this,n)}}var P={Containers:{tc:{margin:"30px auto 0px auto"}},NotificationItem:{info:{border:"solid 8px #007bff",borderRadius:6,padding:20},success:{boxShadow:"1px 1px 3px 1px darkslategrey"}},Title:{success:{color:"#3c763d"}}},U=i()(T.a,{}),W=function(t){p()(o,t);var n=H(o);function o(e,t){var a;return s()(this,o),a=n.call(this,e),b()(u()(a),"restoreNotes",(function(e){for(var t=e.lesson,n=0;n<t.length;n++){var o=t[n];if(o.type===D.ob){var i=o.value,s=i.left,c=i.top,r=i.noteID,l=!1,u=0,d=0,p=null,f=null,h=e[r];if(h)for(var v=h.length-1;v>=0;v--)switch(h[v].type){case D.cb:l=!0;break;case D.xc:f=h[v].value;break;case D.vc:p=h[v].value;break;case D.wc:u+=h[v].value.x,d+=h[v].value.y}s+=u,c+=d,l||a.addNote({left:s,top:c,noteID:r,title:f,body:p})}}})),b()(u()(a),"addNote",(function(e){var t=e.left,n=e.top,o=e.noteID,s=e.body,c=e.title;o||(o=Object(O.a)(3),a.context.log({id:"lesson",type:D.ob,value:{top:n,left:t,noteID:o}}));var r=i()(I.a,{id:o,color:"green",editable:!0,minimizable:!0,removable:!0,draggable:{default:{x:t,y:n}},title:c,body:s},a.state.notes.length),l=a.state.notes.slice();l.push(r),a.setState({notes:l})})),a.state={visible:!t.lessonID||(t.isActive()||t.isOwner()),notes:[]},a}return r()(o,[{key:"componentDidMount",value:function(){var e=this,t=this.context;t.onLessonMount(),this.unsubscribe=t.subscribe((function(n,o){if(n===E.A){var i=o;k()(i.lesson)&&e.restoreNotes(i)}else n!==E.u&&n!==E.x||e.setState({visible:t.isActive()||t.isOwner()})}))}},{key:"render",value:function(){return this.state.visible?i()(x.Fragment,{},void 0,i()(w.b,{attributes:{className:"contextmenu-fullscreen"},holdToDisplay:-1,disableIfShiftIsPressed:!0,id:"lessonWindow"},void 0,i()("div",{id:"Lesson",className:this.props.className,style:this.props.style},void 0,this.props.children,this.state.notes,U)),i()(A.a,{addNote:this.addNote,session:this.context,t:this.props.t}),y.a.createElement(S.a,{ref:function(t){e.notificationSystemISLE=t},allowHTML:!0,style:P})):i()(M.a,{t:this.props.t})}}]),o}(x.Component);W.defaultProps={className:"",style:{}},W.contextType=L.a,t.default=Object(R.a)("Lesson")(W)}.call(this,n(22))}}]);